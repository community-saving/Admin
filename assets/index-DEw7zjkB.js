import{o as Le}from"./rolldown-runtime-O3PcEg2i.js";import{a as Ue,c as Pe,d as Dt,i as Fe,l as Te,n as at,o as Ie,r as Re,s as Ve,t as kt}from"./charting-BTEZ5LFh.js";import{t as Ct}from"./react-dom-B_yxW9B6.js";import{a as ie,c as Ne,i as At,n as ze,o as Lt,r as rt,s as Et,t as Ut}from"./react-router-DN1Q4BFP.js";import{_ as Pt,a as fe,b as Ft,c as le,d as ue,f as nt,g as Tt,h as It,i as De,l as xe,m as ge,n as J,o as Rt,p as ce,r as te,s as Mt,t as $t,u as ae,v as zt,y as Me}from"./firebase-CyM-FwhB.js";import{a as Ot,c as Yt,i as _t,l as Bt,n as Wt,o as qt,r as Vt,s as Kt,t as Gt,u as Ht}from"./react-CbSgh8yl.js";import{C as Zt,D as Qt,E as Jt,O as Xt,S as $e,T as es,_ as it,a as ts,b as lt,c as ss,d as Ke,f as as,g as Oe,h as rs,i as Ge,k as ns,l as is,m as ot,n as ls,o as He,p as os,r as dt,s as be,t as ke,u as ds,v as Ce,w as cs,x as je,y as Ae}from"./lucide-icons-Bw25EZYu.js";import{Bt as ct,Ft as ms,Ht as xs,It as us,Lt as hs,Rt as gs,Vt as ps,zt as fs}from"./vendor-C04N904u.js";(function(){const o=document.createElement("link").relList;if(o&&o.supports&&o.supports("modulepreload"))return;for(const y of document.querySelectorAll('link[rel="modulepreload"]'))h(y);new MutationObserver(y=>{for(const m of y)if(m.type==="childList")for(const w of m.addedNodes)w.tagName==="LINK"&&w.rel==="modulepreload"&&h(w)}).observe(document,{childList:!0,subtree:!0});function i(y){const m={};return y.integrity&&(m.integrity=y.integrity),y.referrerPolicy&&(m.referrerPolicy=y.referrerPolicy),y.crossOrigin==="use-credentials"?m.credentials="include":y.crossOrigin==="anonymous"?m.credentials="omit":m.credentials="same-origin",m}function h(y){if(y.ep)return;y.ep=!0;const m=i(y);fetch(y.href,m)}})();var ys=Le(Ct()),s=Le(Dt()),mt=Ft({apiKey:"AIzaSyBKs_0tOsl6OrDQOSTQDD4ghHv3PHLNFqo",authDomain:"money-saving-community.firebaseapp.com",projectId:"money-saving-community",storageBucket:"money-saving-community.firebasestorage.app",messagingSenderId:"1023049683110",appId:"1:1023049683110:web:fa5c36a12cb20440412467",measurementId:"G-1K6718VQSL"}),pe=Tt(mt),T=Rt(mt),e=Le(Ht()),xt=(0,s.createContext)();const he=()=>(0,s.useContext)(xt),js=({children:a})=>{const[o,i]=(0,s.useState)(null),[h,y]=(0,s.useState)(!0),m=(x,g)=>It(pe,x,g),w=async(x,g)=>{try{const A=await zt(pe,x,g),C=A.user,N=te(T,"users",C.uid),U=await De(N);if(U.exists()&&U.data().isBlocked===!0)throw await Me(pe),new Error("Account is blocked");return A}catch(A){throw A}},p=()=>Me(pe);(0,s.useEffect)(()=>Pt(pe,x=>{i(x),y(!1)}),[]);const j={currentUser:o,signup:m,login:w,logout:p};return(0,e.jsx)(xt.Provider,{value:j,children:h?(0,e.jsx)("div",{className:"min-h-screen flex items-center justify-center bg-gray-50",children:(0,e.jsxs)("div",{className:"text-center",children:[(0,e.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-indigo-600 mx-auto"}),(0,e.jsx)("p",{className:"mt-4 text-gray-600",children:"Loading..."})]})}):a})};function bs(){const a=(0,s.useRef)(),o=(0,s.useRef)(),{login:i}=he(),h=Ne(),[y,m]=(0,s.useState)(""),[w,p]=(0,s.useState)(!1),j=async x=>{x.preventDefault();try{m(""),p(!0),await i(a.current.value,o.current.value),h("/dashboard")}catch(g){g.message==="Account is blocked"?h("/blocked"):m("Failed to sign in. Please check your credentials and try again.")}p(!1)};return(0,e.jsx)("div",{className:"min-h-screen flex items-center justify-center bg-gradient-to-br from-blue-400 to-gray-100 p-4",children:(0,e.jsx)("div",{className:"w-full max-w-md",children:(0,e.jsxs)("form",{onSubmit:j,className:"bg-white p-8 rounded-2xl shadow-lg border border-gray-100",children:[(0,e.jsxs)("div",{className:"text-center mb-8",children:[(0,e.jsx)("div",{className:"mx-auto w-16 h-16 bg-indigo-600 rounded-full flex items-center justify-center mb-4",children:(0,e.jsx)("span",{className:"text-white font-bold text-xl",children:"MB"})}),(0,e.jsx)("h2",{className:"text-2xl font-bold text-gray-900",children:"Welcome Back"}),(0,e.jsx)("p",{className:"text-gray-600 mt-2",children:"Sign in to your account"})]}),y&&(0,e.jsx)("div",{className:"bg-red-50 text-red-700 p-3 rounded-lg mb-6 text-sm",children:y}),(0,e.jsxs)("div",{className:"mb-4",children:[(0,e.jsx)("label",{htmlFor:"email",className:"block text-sm font-medium text-gray-700 mb-1",children:"Email"}),(0,e.jsx)("input",{type:"email",id:"email",ref:a,placeholder:"Enter your email",required:!0,className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500"})]}),(0,e.jsxs)("div",{className:"mb-6",children:[(0,e.jsx)("label",{htmlFor:"password",className:"block text-sm font-medium text-gray-700 mb-1",children:"Password"}),(0,e.jsx)("input",{type:"password",id:"password",ref:o,placeholder:"Enter your password",required:!0,className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500"})]}),(0,e.jsx)("button",{disabled:w,className:"w-full bg-indigo-600 hover:bg-indigo-700 text-white p-2 rounded-lg transition-colors duration-200 disabled:opacity-50",children:w?"Signing In...":"Sign In"}),(0,e.jsxs)("p",{className:"mt-6 text-center text-gray-600",children:["Don't have an account?"," ",(0,e.jsx)(ze,{to:"/signup",className:"text-indigo-600 hover:text-indigo-800 font-medium",children:"Sign Up"})]})]})})})}function Ns(){const a=(0,s.useRef)(),o=(0,s.useRef)(),i=(0,s.useRef)(),{signup:h}=he(),y=Ne(),[m,w]=(0,s.useState)(""),[p,j]=(0,s.useState)(!1),x=async g=>{if(g.preventDefault(),o.current.value!==i.current.value)return w("Passwords do not match");if(o.current.value.length<6)return w("Password should be at least 6 characters");try{w(""),j(!0),await h(a.current.value,o.current.value),y("/dashboard")}catch{w("Failed to create an account. Please try again.")}j(!1)};return(0,e.jsx)("div",{className:"min-h-screen flex items-center justify-center bg-gradient-to-br from-blue-400 to-gray-100 p-4",children:(0,e.jsx)("div",{className:"w-full max-w-md",children:(0,e.jsxs)("form",{onSubmit:x,className:"bg-white p-8 rounded-2xl shadow-lg border border-gray-100",children:[(0,e.jsxs)("div",{className:"text-center mb-8",children:[(0,e.jsx)("div",{className:"mx-auto w-16 h-16 bg-indigo-600 rounded-full flex items-center justify-center mb-4",children:(0,e.jsx)("span",{className:"text-white font-bold text-xl",children:"MB"})}),(0,e.jsx)("h2",{className:"text-2xl font-bold text-gray-900",children:"Create Account"}),(0,e.jsx)("p",{className:"text-gray-600 mt-2",children:"Sign up to get started"})]}),m&&(0,e.jsx)("div",{className:"bg-red-50 text-red-700 p-3 rounded-lg mb-6 text-sm",children:m}),(0,e.jsxs)("div",{className:"mb-4",children:[(0,e.jsx)("label",{htmlFor:"email",className:"block text-sm font-medium text-gray-700 mb-1",children:"Email"}),(0,e.jsx)("input",{type:"email",id:"email",ref:a,placeholder:"Enter your email",required:!0,className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500"})]}),(0,e.jsxs)("div",{className:"mb-4",children:[(0,e.jsx)("label",{htmlFor:"password",className:"block text-sm font-medium text-gray-700 mb-1",children:"Password"}),(0,e.jsx)("input",{type:"password",id:"password",ref:o,placeholder:"Create a password",required:!0,className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500"})]}),(0,e.jsxs)("div",{className:"mb-6",children:[(0,e.jsx)("label",{htmlFor:"confirmPassword",className:"block text-sm font-medium text-gray-700 mb-1",children:"Confirm Password"}),(0,e.jsx)("input",{type:"password",id:"confirmPassword",ref:i,placeholder:"Confirm your password",required:!0,className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500"})]}),(0,e.jsx)("button",{disabled:p,className:"w-full bg-indigo-600 hover:bg-indigo-700 text-white p-2 rounded-lg transition-colors duration-200 disabled:opacity-50",children:p?"Creating Account...":"Sign Up"}),(0,e.jsxs)("p",{className:"mt-6 text-center text-gray-600",children:["Already have an account?"," ",(0,e.jsx)(ze,{to:"/login",className:"text-indigo-600 hover:text-indigo-800 font-medium",children:"Sign In"})]})]})})})}var ws=()=>(0,e.jsx)(e.Fragment,{children:(0,e.jsxs)("div",{children:[(0,e.jsx)("h1",{children:"Create your porfile"}),(0,e.jsxs)("form",{action:"",children:[(0,e.jsx)("input",{type:"text",placeholder:"Your full name "}),(0,e.jsx)("input",{type:"email",placeholder:"Your email",name:"",id:""}),(0,e.jsx)("input",{type:"number",placeholder:"You phone number ",name:"",id:""}),(0,e.jsx)("input",{type:"number",placeholder:"You Age  ",name:"",id:""}),(0,e.jsxs)("option",{value:"",children:[(0,e.jsx)("select",{name:"male",id:"",children:"Male"}),(0,e.jsx)("select",{name:"female",id:"",children:"Female"})]}),(0,e.jsx)("input",{type:"file",placeholder:"Upload your photo"}),(0,e.jsx)("button",{type:"submit",children:"Create account"})]})]})}),vs=ws,Ss=()=>{const[a,o]=(0,s.useState)(0),[i,h]=(0,s.useState)(0),[y,m]=(0,s.useState)(0),[w,p]=(0,s.useState)(0),[j,x]=(0,s.useState)(!1),[g,A]=(0,s.useState)(!1),[C,N]=(0,s.useState)(!1),[U,I]=(0,s.useState)([]),[v,u]=(0,s.useState)([]),[k,S]=(0,s.useState)([]),[R,Y]=(0,s.useState)(!0),[P,_]=(0,s.useState)({width:window.innerWidth,height:window.innerHeight});(0,s.useEffect)(()=>{const d=()=>{_({width:window.innerWidth,height:window.innerHeight})};return window.addEventListener("resize",d),()=>window.removeEventListener("resize",d)},[]);const q=d=>new Date(d).toLocaleString("en-US",{month:"short",day:"numeric",hour:"numeric",hour12:!0});(0,s.useEffect)(()=>{if(!T){N("Firestore instance not available"),Y(!1);return}const d=ae(J(T,"users"),xe("createdAt","desc")),F=le(d,$=>{try{const B=$.docs.map(W=>({id:W.id,...W.data()}));S(B),p(B.length),Y(!1),N(!1)}catch(B){console.error("Error processing users snapshot:",B),N("Failed to process users data"),Y(!1)}},$=>{console.error("Error fetching users:",$),$.code==="permission-denied"?N("Permission denied. Check Firestore rules."):N("Failed to load users: "+($.message||"Unknown error")),Y(!1)});return()=>F()},[]);const X=({active:d,payload:F,label:$})=>{if(d&&F&&F.length){const B=F[0].payload,W=P.width<768;return(0,e.jsxs)("div",{className:`bg-white border border-gray-200 shadow-lg rounded-md ${W?"p-2":"p-4"}`,children:[(0,e.jsx)("p",{className:`font-medium text-gray-900 ${W?"text-xs":"text-sm"}`,children:q(B.timestamp)}),(0,e.jsxs)("p",{className:`text-indigo-600 ${W?"text-xs":"text-sm"}`,children:["Deposits: $",B.deposits.toFixed(2)]}),(0,e.jsxs)("p",{className:`text-red-600 ${W?"text-xs":"text-sm"}`,children:["loans: $",B.loans.toFixed(2)]})]})}return null},f=(d,F,$=20)=>{const B=[];return d.forEach(W=>{const l=W.timestamp?.toDate?.()||new Date(W.timestamp);B.push({timestamp:l,name:l.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"}),deposits:Number(W.amount)||0,loans:0})}),F.forEach(W=>{const l=W.timestamp?.toDate?.()||new Date(W.timestamp);B.push({timestamp:l,name:l.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"}),deposits:0,loans:Number(W.amount)||0})}),B.sort((W,l)=>W.timestamp-l.timestamp),B.slice(-$)};(0,s.useEffect)(()=>{if(!T){console.error("Firestore database instance not available"),x(!0),A(!0);return}let d=[],F=[];const $=ae(J(T,"deposits"),xe("timestamp","desc")),B=le($,z=>{try{let M=0;d=[],z.forEach(K=>{const re=K.data();re.amount&&(M+=parseFloat(re.amount)),d.push({id:K.id,...re,timestamp:re.timestamp})}),o(M),x(!1);const ee=f(d,F);I(ee),u(K=>[...d.slice(0,3).map(re=>({id:re.id,type:"deposit",userId:re.userId,amount:re.amount,timestamp:re.timestamp?.toDate?.()||new Date})),...K].slice(0,6))}catch(M){console.error("Error processing deposits data:",M),x(!0)}},z=>{console.error("Error fetching deposits:",z),x(!0)}),W=ae(J(T,"loans"),xe("timestamp","desc")),l=le(W,z=>{try{let M=0,ee=0;F=[],z.forEach(re=>{const de=re.data();de.amount&&(M+=parseFloat(de.amount)),de.status==="pending"&&(ee+=1),F.push({id:re.id,...de,timestamp:de.timestamp})}),h(M),m(ee),A(!1);const K=f(d,F);I(K),u(re=>[...F.slice(0,3).map(de=>({id:de.id,type:"cashout",userId:de.userId,amount:de.amount,status:de.status,timestamp:de.timestamp?.toDate?.()||new Date})),...re].slice(0,6))}catch(M){console.error("Error processing loans data:",M),A(!0)}},z=>{console.error("Error fetching loans:",z),A(!0)});return()=>{B(),l()}},[]);const D=d=>`$${d.toFixed(2)}`,E=d=>new Date(d).toLocaleDateString("en-US",{month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}),n=[{id:1,name:"Total Deposits",value:j?"N/A":D(a),change:"+12.5%",changeType:"positive",icon:Ce,iconColor:"bg-indigo-500"},{id:2,name:"Total loans",value:g?"N/A":D(i),change:"+8.2%",changeType:"positive",icon:Ae,iconColor:"bg-red-500"},{id:3,name:"Pending loans",value:g?"N/A":y,change:"+3.1%",changeType:"negative",icon:ns,iconColor:"bg-yellow-500"},{id:4,name:"Total Users",value:C?"N/A":w,change:"+5.4%",changeType:"positive",icon:dt,iconColor:"bg-green-500"}],c=(()=>{const d=P.width<768,F=P.width>=768&&P.width<1024;return{margin:{top:d?5:10,right:d?10:30,left:d?5:20,bottom:d?10:5},tickFontSize:d?8:F?10:12,interval:d?"preserveStartEnd":0,minTickGap:d?10:15,barSize:d?10:15,animationDuration:d?500:800,gridStrokeDasharray:d?"2 2":"3 3"}})();return R?(0,e.jsx)("div",{className:"flex items-center justify-center h-96",children:(0,e.jsxs)("div",{className:"text-center",children:[(0,e.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-indigo-600 mx-auto"}),(0,e.jsx)("p",{className:"mt-4 text-gray-600",children:"Loading dashboard..."})]})}):(0,e.jsxs)("div",{className:"space-y-6",children:[(0,e.jsx)("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4 sm:gap-6",children:n.map(d=>(0,e.jsxs)("div",{className:"bg-white rounded-2xl shadow-sm p-4 sm:p-6 transition-all duration-200 hover:shadow-md",children:[(0,e.jsxs)("div",{className:"flex items-center justify-between",children:[(0,e.jsxs)("div",{children:[(0,e.jsx)("p",{className:"text-xs sm:text-sm font-medium text-gray-500",children:d.name}),(0,e.jsx)("p",{className:"mt-1 sm:mt-2 text-2xl sm:text-3xl font-bold text-gray-900",children:d.value})]}),(0,e.jsx)("div",{className:`p-2 sm:p-3 rounded-full ${d.iconColor}`,children:(0,e.jsx)(d.icon,{className:"h-5 w-5 sm:h-6 sm:w-6 text-white"})})]}),(0,e.jsxs)("div",{className:"mt-3 sm:mt-4 flex items-center",children:[d.changeType==="positive"?(0,e.jsx)(Qt,{className:"h-3 w-3 sm:h-4 sm:w-4 text-green-500"}):(0,e.jsx)(Xt,{className:"h-3 w-3 sm:h-4 sm:w-4 text-red-500"}),(0,e.jsx)("span",{className:`ml-1 text-xs sm:text-sm font-medium ${d.changeType==="positive"?"text-green-500":"text-red-500"}`,children:d.change}),(0,e.jsx)("span",{className:"ml-1 sm:ml-2 text-xs sm:text-sm text-gray-500",children:"from last month"})]})]},d.id))}),(0,e.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-4 sm:gap-6",children:[(0,e.jsxs)("div",{className:"bg-white rounded-2xl shadow-sm p-4 sm:p-6",children:[(0,e.jsx)("h3",{className:"text-base sm:text-lg font-medium text-gray-900 mb-3 sm:mb-4",children:"Live Transactions"}),(0,e.jsx)("div",{className:"h-64 sm:h-80 overflow-x-auto",children:(0,e.jsx)(Te,{width:"100%",height:"100%",minWidth:300,children:(0,e.jsxs)(kt,{data:U,margin:c.margin,children:[(0,e.jsx)(Ie,{strokeDasharray:c.gridStrokeDasharray}),(0,e.jsx)(Fe,{dataKey:"name",tick:{fontSize:c.tickFontSize},interval:c.interval,minTickGap:c.minTickGap}),(0,e.jsx)(Re,{tick:{fontSize:c.tickFontSize}}),(0,e.jsx)(Pe,{content:(0,e.jsx)(X,{})}),(0,e.jsx)(Ve,{dataKey:"deposits",fill:"#4f46e5",name:"Deposits",barSize:c.barSize,isAnimationActive:!0,animationDuration:c.animationDuration,animationEasing:"ease-in-out"}),(0,e.jsx)(Ve,{dataKey:"loans",fill:"#ef4444",name:"loans",barSize:c.barSize,isAnimationActive:!0,animationDuration:c.animationDuration,animationEasing:"ease-in-out"})]})})})]}),(0,e.jsxs)("div",{className:"bg-white rounded-2xl shadow-sm p-4 sm:p-6",children:[(0,e.jsx)("h3",{className:"text-base sm:text-lg font-medium text-gray-900 mb-3 sm:mb-4",children:"Transaction Trend"}),(0,e.jsx)("div",{className:"h-64 sm:h-80 overflow-x-auto",children:(0,e.jsx)(Te,{width:"100%",height:"100%",minWidth:300,children:(0,e.jsxs)(at,{data:U,margin:c.margin,children:[(0,e.jsx)(Ie,{strokeDasharray:c.gridStrokeDasharray}),(0,e.jsx)(Fe,{dataKey:"name",tick:{fontSize:c.tickFontSize},interval:c.interval,minTickGap:c.minTickGap}),(0,e.jsx)(Re,{tick:{fontSize:c.tickFontSize}}),(0,e.jsx)(Pe,{content:(0,e.jsx)(X,{})}),(0,e.jsx)(Ue,{type:"monotone",dataKey:"deposits",stroke:"#4f46e5",activeDot:{r:P.width<768?4:8},name:"Deposits",strokeWidth:P.width<768?1.5:2,isAnimationActive:!0,animationDuration:c.animationDuration,animationEasing:"ease-in-out"}),(0,e.jsx)(Ue,{type:"monotone",dataKey:"loans",stroke:"#ef4444",name:"loans",strokeWidth:P.width<768?1.5:2,isAnimationActive:!0,animationDuration:c.animationDuration,animationEasing:"ease-in-out"})]})})})]})]}),(0,e.jsxs)("div",{className:"bg-white rounded-2xl shadow-sm p-4 sm:p-6",children:[(0,e.jsxs)("div",{className:"flex items-center justify-between mb-3 sm:mb-4",children:[(0,e.jsx)("h3",{className:"text-base sm:text-lg font-medium text-gray-900",children:"Recent Activity"}),(0,e.jsx)("button",{className:"text-sm font-medium text-indigo-600 hover:text-indigo-800",children:"View all"})]}),(0,e.jsx)("div",{className:"overflow-x-auto",children:(0,e.jsxs)("table",{className:"min-w-full divide-y divide-gray-200",children:[(0,e.jsx)("thead",{className:"bg-gray-50",children:(0,e.jsxs)("tr",{children:[(0,e.jsx)("th",{scope:"col",className:"px-3 sm:px-6 py-2 sm:py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Type"}),(0,e.jsx)("th",{scope:"col",className:"px-3 sm:px-6 py-2 sm:py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"User ID"}),(0,e.jsx)("th",{scope:"col",className:"px-3 sm:px-6 py-2 sm:py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Amount"}),(0,e.jsx)("th",{scope:"col",className:"px-3 sm:px-6 py-2 sm:py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Status"}),(0,e.jsx)("th",{scope:"col",className:"px-3 sm:px-6 py-2 sm:py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Date"})]})}),(0,e.jsx)("tbody",{className:"bg-white divide-y divide-gray-200",children:v.length>0?v.map(d=>(0,e.jsxs)("tr",{className:"hover:bg-gray-50 transition-colors duration-150",children:[(0,e.jsx)("td",{className:"px-3 sm:px-6 py-3 sm:py-4 whitespace-nowrap",children:(0,e.jsxs)("div",{className:"flex items-center",children:[d.type==="deposit"?(0,e.jsx)("div",{className:"w-6 h-6 sm:w-8 sm:h-8 rounded-full bg-indigo-100 flex items-center justify-center",children:(0,e.jsx)(Ce,{className:"h-3 w-3 sm:h-4 sm:w-4 text-indigo-600"})}):(0,e.jsx)("div",{className:"w-6 h-6 sm:w-8 sm:h-8 rounded-full bg-red-100 flex items-center justify-center",children:(0,e.jsx)(Ae,{className:"h-3 w-3 sm:h-4 sm:w-4 text-red-600"})}),(0,e.jsx)("span",{className:"ml-2 sm:ml-3 text-xs sm:text-sm font-medium text-gray-900 capitalize",children:d.type})]})}),(0,e.jsx)("td",{className:"px-3 sm:px-6 py-3 sm:py-4 whitespace-nowrap text-xs sm:text-sm text-gray-500",children:d.userId||"N/A"}),(0,e.jsx)("td",{className:"px-3 sm:px-6 py-3 sm:py-4 whitespace-nowrap text-xs sm:text-sm font-medium text-gray-900",children:D(d.amount||0)}),(0,e.jsx)("td",{className:"px-3 sm:px-6 py-3 sm:py-4 whitespace-nowrap",children:d.type==="deposit"?(0,e.jsx)("span",{className:"px-2 inline-flex text-xs leading-5 font-semibold rounded-full bg-green-100 text-green-800",children:"Completed"}):(0,e.jsx)("span",{className:`px-2 inline-flex text-xs leading-5 font-semibold rounded-full ${d.status==="Pending"?"bg-yellow-100 text-yellow-800":d.status==="Accepted"?"bg-green-100 text-green-800":"bg-red-100 text-red-800"}`,children:d.status||"Pending"})}),(0,e.jsx)("td",{className:"px-3 sm:px-6 py-3 sm:py-4 whitespace-nowrap text-xs sm:text-sm text-gray-500",children:E(d.timestamp)})]},d.id)):(0,e.jsx)("tr",{children:(0,e.jsx)("td",{colSpan:"5",className:"px-3 sm:px-6 py-3 sm:py-4 text-center text-xs sm:text-sm text-gray-500",children:"No recent activity"})})})]})})]})]})},Ze=Ss,Ds=()=>{const{currentUser:a}=he(),[o,i]=(0,s.useState)([]),[h,y]=(0,s.useState)([]),[m,w]=(0,s.useState)(!0),[p,j]=(0,s.useState)(null),[x,g]=(0,s.useState)(""),[A,C]=(0,s.useState)(null),[N,U]=(0,s.useState)(!1),[I,v]=(0,s.useState)(new Set);(0,s.useEffect)(()=>{if(!a)return;const f=le(J(T,"users"),D=>{const E=[];D.forEach(n=>{E.push({id:n.id,...n.data()})}),y(E)},D=>{console.error("Error fetching users:",D)});return()=>f()},[a]),(0,s.useEffect)(()=>{if(!a)return;const f=le(J(T,"loans"),D=>{const E=[];D.forEach(n=>{E.push({id:n.id,...n.data()})}),E.sort((n,r)=>{const c=n.paymentTimestamp?.toDate?.()||new Date(0);return(r.paymentTimestamp?.toDate?.()||new Date(0))-c}),i(E),w(!1)},D=>{console.error("Error fetching paybacks:",D),w(!1)});return()=>f()},[a]);const u=o.map(f=>{const D=h.find(E=>E.uid===f.userId);return{...f,userName:D?.fullName||"Unknown User",userEmail:D?.email||"No email provided"}}),k=(f,D)=>{j({message:f,type:D}),setTimeout(()=>{j(null)},3e3)},S=async f=>{try{v(D=>new Set(D).add(f)),setTimeout(async()=>{const D=te(T,"loans",f);await ce(D,{paymentStatus:"approved",adminReviewedAt:ue()}),setTimeout(()=>{v(E=>{const n=new Set(E);return n.delete(f),n})},300),k("Payment approved successfully!","success")},100)}catch(D){console.error("Error approving payment:",D),k("Failed to approve payment. Please try again.","error"),v(E=>{const n=new Set(E);return n.delete(f),n})}},R=async f=>{try{v(D=>new Set(D).add(f)),setTimeout(async()=>{const D=te(T,"loans",f);await ce(D,{paymentStatus:"denied",adminReviewedAt:ue()}),setTimeout(()=>{v(E=>{const n=new Set(E);return n.delete(f),n})},300),k("Payment denied.","error")},100)}catch(D){console.error("Error denying payment:",D),k("Failed to deny payment. Please try again.","error"),v(E=>{const n=new Set(E);return n.delete(f),n})}},Y=f=>{C(f),U(!0)},P=()=>{U(!1),C(null)},_=f=>{if(!f)return"N/A";const D=f.toDate(),E=D.getDate().toString().padStart(2,"0"),n=(D.getMonth()+1).toString().padStart(2,"0"),r=D.getFullYear(),c=D.getHours().toString().padStart(2,"0"),d=D.getMinutes().toString().padStart(2,"0");return`${E}/${n}/${r} ${c}:${d}`},q=u.filter(f=>{if(f.status!=="accepted")return!1;const D=f.userName||"",E=x.toLowerCase();return D.toLowerCase().includes(E)}),X=u.filter(f=>f.status==="accepted"&&f.paymentStatus==="pending").length;return(0,e.jsxs)("div",{className:"min-h-screen bg-gray-50 py-8",children:[p&&(0,e.jsx)("div",{className:`fixed top-4 right-4 z-50 px-6 py-4 rounded-lg shadow-lg transform transition-all duration-300 ${p.type==="success"?"bg-green-500 text-white":"bg-red-500 text-white"}`,children:p.message}),(0,e.jsxs)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:[(0,e.jsxs)("div",{className:"mb-8",children:[(0,e.jsx)("h1",{className:"text-3xl font-bold text-gray-900",children:"Loan Repayment Management"}),(0,e.jsx)("p",{className:"mt-2 text-gray-600",children:"Review and manage loan repayments for accepted loans"})]}),(0,e.jsx)("div",{className:"bg-white rounded-xl shadow-sm p-6 mb-6",children:(0,e.jsxs)("div",{className:"relative",children:[(0,e.jsx)("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:(0,e.jsx)(be,{className:"h-5 w-5 text-gray-400"})}),(0,e.jsx)("input",{type:"text",placeholder:"Search by user name...",value:x,onChange:f=>g(f.target.value),className:"block w-full pl-10 pr-3 py-3 border border-gray-300 rounded-lg bg-gray-50 focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500"})]})}),(0,e.jsxs)("div",{className:"bg-white rounded-xl shadow-sm p-6",children:[(0,e.jsxs)("div",{className:"flex justify-between items-center mb-6",children:[(0,e.jsx)("h2",{className:"text-xl font-semibold text-gray-900",children:"Accepted Loan Repayments"}),(0,e.jsxs)("span",{className:"inline-flex items-center px-3 py-1 rounded-full text-sm font-medium bg-yellow-100 text-yellow-800",children:[X," pending"]})]}),m?(0,e.jsxs)("div",{className:"flex flex-col items-center justify-center py-12",children:[(0,e.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-indigo-600 mb-4"}),(0,e.jsx)("p",{className:"text-gray-600",children:"Loading loan repayments..."})]}):q.length===0?(0,e.jsxs)("div",{className:"text-center py-12",children:[(0,e.jsx)("div",{className:"mx-auto h-16 w-16 rounded-full bg-gray-100 flex items-center justify-center mb-4",children:(0,e.jsx)(be,{className:"h-8 w-8 text-gray-400"})}),(0,e.jsx)("h3",{className:"text-lg font-medium text-gray-900 mb-1",children:"No accepted loans found"}),(0,e.jsx)("p",{className:"text-gray-500",children:"There are no accepted loans at the moment."})]}):(0,e.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:q.map(f=>{const D=I.has(f.id),E=!f.paymentStatus||f.paymentStatus==="pending";return(0,e.jsx)("div",{className:`bg-white rounded-xl border border-gray-200 shadow-sm overflow-hidden transition-all duration-300 hover:shadow-md ${D?"opacity-0 scale-95":"opacity-100 scale-100"}`,children:(0,e.jsxs)("div",{className:"p-6",children:[(0,e.jsxs)("div",{className:"flex justify-between items-start mb-4",children:[(0,e.jsxs)("div",{className:"flex items-center",children:[(0,e.jsx)("div",{className:"flex-shrink-0 h-10 w-10 rounded-full bg-indigo-100 flex items-center justify-center",children:(0,e.jsx)("span",{className:"text-indigo-800 font-medium",children:f.userName?.charAt(0)?.toUpperCase()||"U"})}),(0,e.jsxs)("div",{className:"ml-3",children:[(0,e.jsx)("h3",{className:"text-sm font-medium text-gray-900",children:f.userName||"Unknown User"}),(0,e.jsx)("p",{className:"text-sm text-gray-500",children:f.userEmail||"No email provided"})]})]}),(0,e.jsx)("span",{className:`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium
                            ${f.paymentStatus==="approved"?"bg-green-100 text-green-800":f.paymentStatus==="denied"?"bg-red-100 text-red-800":"bg-yellow-100 text-yellow-800"}`,children:f.paymentStatus?.charAt(0)?.toUpperCase()+f.paymentStatus?.slice(1)||"Pending"})]}),(0,e.jsxs)("div",{className:"space-y-3 mb-6",children:[(0,e.jsxs)("div",{className:"flex justify-between",children:[(0,e.jsx)("span",{className:"text-sm text-gray-500",children:"Loan Amount"}),(0,e.jsxs)("span",{className:"text-sm font-medium text-gray-900",children:["$",f.amount]})]}),(0,e.jsxs)("div",{className:"flex justify-between",children:[(0,e.jsx)("span",{className:"text-sm text-gray-500",children:"Interest (10%)"}),(0,e.jsxs)("span",{className:"text-sm font-medium text-gray-900",children:["$",(f.amount*.1).toFixed(2)]})]}),(0,e.jsxs)("div",{className:"flex justify-between",children:[(0,e.jsx)("span",{className:"text-sm text-gray-500",children:"Total Payable"}),(0,e.jsxs)("span",{className:"text-sm font-medium text-gray-900",children:["$",f.totalPayable?.toFixed(2)||(f.amount*1.1).toFixed(2)]})]}),(0,e.jsxs)("div",{className:"flex justify-between",children:[(0,e.jsx)("span",{className:"text-sm text-gray-500",children:"Paid Amount"}),(0,e.jsxs)("span",{className:"text-sm font-medium text-gray-900",children:["$",f.paidAmount]})]}),(0,e.jsxs)("div",{className:"flex justify-between",children:[(0,e.jsx)("span",{className:"text-sm text-gray-500",children:"Payment Date"}),(0,e.jsx)("span",{className:"text-sm font-medium text-gray-900",children:_(f.paymentTimestamp)})]}),f.adminReviewedAt&&(0,e.jsxs)("div",{className:"flex justify-between",children:[(0,e.jsx)("span",{className:"text-sm text-gray-500",children:"Reviewed At"}),(0,e.jsx)("span",{className:"text-sm font-medium text-gray-900",children:_(f.adminReviewedAt)})]})]}),(0,e.jsxs)("div",{className:"mb-6",children:[(0,e.jsx)("span",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Proof of Payment"}),f.proofImageUrl?(0,e.jsxs)("div",{className:"relative w-full h-32 rounded-lg overflow-hidden cursor-pointer border border-gray-200",onClick:()=>Y(f.proofImageUrl),children:[(0,e.jsx)("img",{src:f.proofImageUrl,alt:"Proof of payment",className:"w-full h-full object-cover"}),(0,e.jsx)("div",{className:"absolute inset-0 bg-black bg-opacity-30 flex items-center justify-center opacity-0 hover:opacity-100 transition-opacity",children:(0,e.jsx)(Oe,{className:"h-6 w-6 text-white"})})]}):(0,e.jsx)("div",{className:"w-full h-32 rounded-lg bg-gray-100 flex items-center justify-center border border-gray-200",children:(0,e.jsx)("span",{className:"text-gray-500 text-sm",children:"No proof provided"})})]}),(0,e.jsxs)("div",{className:"flex space-x-3",children:[(0,e.jsxs)("button",{className:`flex-1 inline-flex items-center justify-center px-4 py-2 border border-transparent text-sm font-medium rounded-lg transition-colors ${E?"text-white bg-green-600 hover:bg-green-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-green-500":"text-gray-400 bg-gray-100 cursor-not-allowed"}`,onClick:()=>S(f.id),disabled:!E,children:[(0,e.jsx)(Zt,{className:"-ml-1 mr-2 h-4 w-4"}),"Approve"]}),(0,e.jsxs)("button",{className:`flex-1 inline-flex items-center justify-center px-4 py-2 border text-sm font-medium rounded-lg transition-colors ${E?"text-gray-700 bg-white border-gray-300 hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500":"text-gray-400 bg-gray-100 border-gray-200 cursor-not-allowed"}`,onClick:()=>R(f.id),disabled:!E,children:[(0,e.jsx)(ke,{className:"-ml-1 mr-2 h-4 w-4"}),"Deny"]})]})]})},f.id)})})]})]}),N&&(0,e.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-75 flex items-center justify-center z-50 p-4",onClick:P,children:(0,e.jsxs)("div",{className:"relative max-w-4xl max-h-full",onClick:f=>f.stopPropagation(),children:[(0,e.jsx)("button",{className:"absolute -top-12 right-0 text-white hover:text-gray-300 focus:outline-none",onClick:P,children:(0,e.jsx)(ke,{className:"h-8 w-8"})}),(0,e.jsx)("img",{src:A,alt:"Proof of payment",className:"max-w-full max-h-screen rounded-lg"})]})})]})},ks=Ds,Cs=()=>{const[a,o]=(0,s.useState)([]),[i,h]=(0,s.useState)([]),[y,m]=(0,s.useState)(!0),[w,p]=(0,s.useState)(null),[j,x]=(0,s.useState)(""),[g,A]=(0,s.useState)("All"),[C,N]=(0,s.useState)(null),[U,I]=(0,s.useState)(!1),[v,u]=(0,s.useState)({});(0,s.useEffect)(()=>{const r=ae(J(T,"users")),c=le(r,d=>{const F=d.docs.map($=>({id:$.id,...$.data()}));h(F)},d=>{console.error("Error loading users:",d),p("Failed to load users: "+d.message)});return()=>c()},[]),(0,s.useEffect)(()=>{const r=ae(J(T,"deposits"),xe("timestamp","desc")),c=le(r,d=>{try{const F=d.docs.map($=>({id:$.id,...$.data()})).map($=>{const B=i.find(W=>W.uid===$.userId);return{...$,userName:B?B.fullName||"Unnamed User":"Unknown User"}});o(F),m(!1)}catch(F){console.error("Error merging deposit data:",F),p("Error processing deposit data: "+F.message),m(!1)}},d=>{console.error("Firestore error:",d),p("Failed to load deposits: "+d.message),m(!1)});return()=>c()},[i]);const k=r=>{switch(r){case"accepted":return"bg-green-100 text-green-800";case"denied":return"bg-red-100 text-red-800";case"pending":return"bg-yellow-100 text-yellow-800";default:return"bg-gray-100 text-gray-800"}},S=async(r,c)=>{try{const d=te(T,"deposits",r);await ce(d,{status:c}),console.log(`Deposit ${r} status updated to ${c}`)}catch(d){console.error("Error updating deposit status:",d),p("Failed to update deposit status: "+d.message)}},R=r=>{if(!r)return"N/A";if(r.seconds){const c=new Date(r.seconds*1e3);return c.toLocaleDateString()+" "+c.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})}if(r.toDate){const c=r.toDate();return c.toLocaleDateString()+" "+c.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})}return r.toString()},Y=a.reduce((r,c)=>r+(parseFloat(c.amount)||0),0),P=a.filter(r=>r.status==="pending").length,_=a.filter(r=>r.status==="accepted").length,q=a.filter(r=>r.status==="denied").length,X=a.filter(r=>r.status==="accepted").reduce((r,c)=>r+(parseFloat(c.amount)||0),0),f=a.filter(r=>r.status==="denied").reduce((r,c)=>r+(parseFloat(c.amount)||0),0),D=a.filter(r=>{const c=r.userName?.toLowerCase().includes(j.toLowerCase())||r.userId?.toLowerCase().includes(j.toLowerCase())||r.message?.toLowerCase().includes(j.toLowerCase()),d=g==="All"||r.status===g;return c&&d}),E=r=>{N(r),I(!0)},n=()=>{I(!1),N(null)};return y?(0,e.jsx)("div",{className:"flex items-center justify-center h-96",children:(0,e.jsxs)("div",{className:"text-center",children:[(0,e.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-indigo-600 mx-auto"}),(0,e.jsx)("p",{className:"mt-4 text-gray-600",children:"Loading deposits..."})]})}):w?(0,e.jsxs)("div",{className:"bg-white rounded-2xl shadow-sm p-6 text-center",children:[(0,e.jsxs)("p",{className:"text-red-500",children:["Error: ",w]}),(0,e.jsx)("button",{onClick:()=>window.location.reload(),className:"mt-4 px-4 py-2 bg-indigo-600 text-white rounded-lg hover:bg-indigo-700 transition-colors duration-200",children:"Retry"})]}):(console.log("DepositsPage: Rendering with deposits array length:",a.length),(0,e.jsxs)("div",{className:"space-y-6",children:[(0,e.jsxs)("div",{className:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-6",children:[(0,e.jsx)("div",{className:"bg-white rounded-2xl shadow-sm p-6",children:(0,e.jsxs)("div",{className:"flex items-center justify-between",children:[(0,e.jsxs)("div",{children:[(0,e.jsx)("p",{className:"text-sm font-medium text-gray-500",children:"Total Deposits"}),(0,e.jsxs)("p",{className:"mt-2 text-3xl font-bold text-gray-900",children:["$",Y.toFixed(2)]})]}),(0,e.jsx)("div",{className:"p-3 rounded-full bg-indigo-100",children:(0,e.jsx)(Ce,{className:"h-6 w-6 text-indigo-600"})})]})}),(0,e.jsx)("div",{className:"bg-white rounded-2xl shadow-sm p-6",children:(0,e.jsxs)("div",{className:"flex items-center justify-between",children:[(0,e.jsxs)("div",{children:[(0,e.jsx)("p",{className:"text-sm font-medium text-gray-500",children:"Pending Deposits"}),(0,e.jsx)("p",{className:"mt-2 text-3xl font-bold text-gray-900",children:P})]}),(0,e.jsx)("div",{className:"p-3 rounded-full bg-yellow-100",children:(0,e.jsx)(lt,{className:"h-6 w-6 text-yellow-600"})})]})}),(0,e.jsx)("div",{className:"bg-white rounded-2xl shadow-sm p-6",children:(0,e.jsxs)("div",{className:"flex items-center justify-between",children:[(0,e.jsxs)("div",{children:[(0,e.jsx)("p",{className:"text-sm font-medium text-gray-500",children:"Approved Deposits"}),(0,e.jsx)("p",{className:"mt-2 text-3xl font-bold text-gray-900",children:_})]}),(0,e.jsx)("div",{className:"p-3 rounded-full bg-green-100",children:(0,e.jsx)($e,{className:"h-6 w-6 text-green-600"})})]})}),(0,e.jsx)("div",{className:"bg-white rounded-2xl shadow-sm p-6",children:(0,e.jsxs)("div",{className:"flex items-center justify-between",children:[(0,e.jsxs)("div",{children:[(0,e.jsx)("p",{className:"text-sm font-medium text-gray-500",children:"Denied Deposits"}),(0,e.jsx)("p",{className:"mt-2 text-3xl font-bold text-gray-900",children:q})]}),(0,e.jsx)("div",{className:"p-3 rounded-full bg-red-100",children:(0,e.jsx)(je,{className:"h-6 w-6 text-red-600"})})]})}),(0,e.jsx)("div",{className:"bg-white rounded-2xl shadow-sm p-6",children:(0,e.jsxs)("div",{className:"flex items-center justify-between",children:[(0,e.jsxs)("div",{children:[(0,e.jsx)("p",{className:"text-sm font-medium text-gray-500",children:"Total Accepted Amount"}),(0,e.jsxs)("p",{className:"mt-2 text-3xl font-bold text-gray-900",children:["$",X.toFixed(2)]})]}),(0,e.jsx)("div",{className:"p-3 rounded-full bg-green-100",children:(0,e.jsx)($e,{className:"h-6 w-6 text-green-600"})})]})}),(0,e.jsx)("div",{className:"bg-white rounded-2xl shadow-sm p-6",children:(0,e.jsxs)("div",{className:"flex items-center justify-between",children:[(0,e.jsxs)("div",{children:[(0,e.jsx)("p",{className:"text-sm font-medium text-gray-500",children:"Total Declined Amount"}),(0,e.jsxs)("p",{className:"mt-2 text-3xl font-bold text-gray-900",children:["$",f.toFixed(2)]})]}),(0,e.jsx)("div",{className:"p-3 rounded-full bg-red-100",children:(0,e.jsx)(je,{className:"h-6 w-6 text-red-600"})})]})})]}),(0,e.jsx)("div",{className:"bg-white rounded-2xl shadow-sm p-6",children:(0,e.jsxs)("div",{className:"flex flex-col md:flex-row md:items-center md:justify-between space-y-4 md:space-y-0",children:[(0,e.jsx)("h2",{className:"text-lg font-medium text-gray-900",children:"Deposit Records"}),(0,e.jsxs)("div",{className:"flex flex-col sm:flex-row space-y-2 sm:space-y-0 sm:space-x-4",children:[(0,e.jsxs)("div",{className:"relative",children:[(0,e.jsx)("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:(0,e.jsx)(be,{className:"h-5 w-5 text-gray-400"})}),(0,e.jsx)("input",{type:"text",placeholder:"Search by name, user ID or message...",className:"block w-full pl-10 pr-3 py-2 border border-gray-300 rounded-lg bg-gray-50 focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm",value:j,onChange:r=>x(r.target.value)})]}),(0,e.jsxs)("div",{className:"relative",children:[(0,e.jsxs)("select",{className:"block w-full pl-3 pr-10 py-2 text-base border-gray-300 focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm rounded-lg bg-gray-50",value:g,onChange:r=>A(r.target.value),children:[(0,e.jsx)("option",{value:"All",children:"All Statuses"}),(0,e.jsx)("option",{value:"pending",children:"Pending"}),(0,e.jsx)("option",{value:"accepted",children:"Accepted"}),(0,e.jsx)("option",{value:"denied",children:"Denied"})]}),(0,e.jsx)("div",{className:"absolute inset-y-0 right-0 flex items-center pr-3 pointer-events-none",children:(0,e.jsx)(ot,{className:"h-5 w-5 text-gray-400"})})]})]})]})}),(0,e.jsx)("div",{className:"bg-white rounded-2xl shadow-sm overflow-scroll",children:(0,e.jsx)("div",{className:"overflow-x-auto",children:(0,e.jsxs)("table",{className:"min-w-full divide-y divide-gray-200",children:[(0,e.jsx)("thead",{className:"bg-gray-50",children:(0,e.jsxs)("tr",{children:[(0,e.jsx)("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"User Name"}),(0,e.jsx)("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Amount"}),(0,e.jsx)("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Status"}),(0,e.jsx)("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Proof"}),(0,e.jsx)("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Date"}),(0,e.jsx)("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Actions"})]})}),(0,e.jsx)("tbody",{className:"bg-white divide-y divide-gray-200",children:D.length>0?D.map(r=>(0,e.jsxs)("tr",{className:"hover:bg-gray-50 transition-colors duration-150",children:[(0,e.jsxs)("td",{className:"px-6 py-4 whitespace-nowrap",children:[(0,e.jsx)("div",{className:"text-sm font-medium text-gray-900",children:r.userName}),(0,e.jsxs)("div",{className:"text-xs text-gray-500 italic",children:["ID: ",r.userId]})]}),(0,e.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,e.jsxs)("div",{className:"text-sm font-semibold text-gray-900",children:["$",r.amount?parseFloat(r.amount).toFixed(2):"0.00"]})}),(0,e.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,e.jsx)("span",{className:`px-2 inline-flex text-xs leading-5 font-semibold rounded-full ${k(r.status||"pending")}`,children:r.status||"pending"})}),(0,e.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:r.imageUrl?(0,e.jsxs)("button",{onClick:()=>E(r),className:"text-indigo-600 hover:text-indigo-900 flex items-center",children:[(0,e.jsx)(Oe,{className:"h-4 w-4 mr-1"}),"View"]}):(0,e.jsx)("span",{className:"text-gray-400",children:"No proof"})}),(0,e.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:R(r.timestamp)}),(0,e.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium",children:(0,e.jsxs)("div",{className:"flex items-center space-x-3",children:[r.status==="pending"?(0,e.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,e.jsx)("button",{disabled:!!v[r.id],onClick:async()=>{if(window.confirm("Mark this deposit as Accepted?")){u(c=>({...c,[r.id]:!0}));try{await S(r.id,"accepted"),console.log("Deposit accepted:",r.id)}finally{u(c=>{const d={...c};return delete d[r.id],d})}}},className:"px-3 py-1 bg-green-100 text-green-700 rounded-lg hover:bg-green-200 transition-colors duration-200 disabled:opacity-50",children:v[r.id]?"Processing...":"Approve"}),(0,e.jsx)("button",{disabled:!!v[r.id],onClick:async()=>{if(window.confirm("Mark this deposit as Denied?")){u(c=>({...c,[r.id]:!0}));try{await S(r.id,"denied"),console.log("Deposit denied:",r.id)}finally{u(c=>{const d={...c};return delete d[r.id],d})}}},className:"px-3 py-1 bg-red-100 text-red-700 rounded-lg hover:bg-red-200 transition-colors duration-200 disabled:opacity-50",children:v[r.id]?"Processing...":"Deny"})]}):(0,e.jsx)("span",{className:"text-sm text-gray-500",children:r.status||"No actions"}),r.imageUrl?(0,e.jsx)("button",{onClick:()=>window.open(r.imageUrl,"_blank"),className:"text-indigo-600 hover:text-indigo-900 flex items-center",title:"View proof in new tab",children:(0,e.jsx)(it,{className:"h-4 w-4"})}):null]})})]},r.id)):(0,e.jsx)("tr",{children:(0,e.jsx)("td",{colSpan:"6",className:"px-6 py-4 text-center text-sm text-gray-500",children:"No deposits found."})})})]})})}),U&&C&&(0,e.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:(0,e.jsxs)("div",{className:"bg-white  rounded-2xl shadow-xl max-w-4xl w-full max-h-[90vh] overflow-scroll",children:[(0,e.jsxs)("div",{className:"p-6 border-b border-gray-200 flex justify-between items-center",children:[(0,e.jsx)("h3",{className:"text-lg font-medium text-gray-900",children:"Deposit Proof"}),(0,e.jsx)("button",{onClick:n,className:"text-gray-400 hover:text-gray-500",children:(0,e.jsx)(je,{className:"h-6 w-6"})})]}),(0,e.jsxs)("div",{className:"p-6",children:[(0,e.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,e.jsxs)("div",{children:[(0,e.jsx)("h4",{className:"text-sm font-medium text-gray-500 mb-1",children:"User Name"}),(0,e.jsx)("p",{className:"text-sm text-gray-900",children:C.userName||"N/A"})]}),(0,e.jsxs)("div",{children:[(0,e.jsx)("h4",{className:"text-sm font-medium text-gray-500 mb-1",children:"User ID"}),(0,e.jsx)("p",{className:"text-sm text-gray-900",children:C.userId||"N/A"})]}),(0,e.jsxs)("div",{children:[(0,e.jsx)("h4",{className:"text-sm font-medium text-gray-500 mb-1",children:"Amount"}),(0,e.jsxs)("p",{className:"text-sm text-gray-900",children:["$",C.amount?parseFloat(C.amount).toFixed(2):"0.00"]})]}),(0,e.jsxs)("div",{children:[(0,e.jsx)("h4",{className:"text-sm font-medium text-gray-500 mb-1",children:"Status"}),(0,e.jsx)("span",{className:`px-2 inline-flex text-xs leading-5 font-semibold rounded-full ${k(C.status||"pending")}`,children:C.status||"pending"})]}),(0,e.jsxs)("div",{children:[(0,e.jsx)("h4",{className:"text-sm font-medium text-gray-500 mb-1",children:"Date"}),(0,e.jsx)("p",{className:"text-sm text-gray-900",children:R(C.timestamp)})]}),(0,e.jsxs)("div",{className:"md:col-span-2",children:[(0,e.jsx)("h4",{className:"text-sm font-medium text-gray-500 mb-1",children:"Message"}),(0,e.jsx)("p",{className:"text-sm text-gray-900",children:C.message||"No message"})]})]}),(0,e.jsxs)("div",{className:"mt-6",children:[(0,e.jsx)("h4",{className:"text-sm font-medium text-gray-500 mb-2",children:"Proof Image"}),(0,e.jsx)("div",{className:"border border-gray-200 rounded-lg ",children:C.imageUrl?(0,e.jsx)("img",{src:C.imageUrl,alt:"Deposit Proof",className:"w-full h-auto max-h-[60vh] object-contain",onError:r=>{r.target.style.display="none"}}):(0,e.jsx)("div",{className:"flex items-center justify-center h-64 bg-gray-100 text-gray-500",children:"No image available"})})]}),(0,e.jsxs)("div",{className:"mt-6 flex justify-end space-x-3",children:[(0,e.jsx)("button",{onClick:n,className:"px-4 py-2 border border-gray-300 text-sm font-medium rounded-lg text-gray-700 bg-white hover:bg-gray-50",children:"Close"}),C.status==="pending"&&(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)("button",{onClick:()=>{S(C.id,"accepted"),n()},className:"px-4 py-2 border border-transparent text-sm font-medium rounded-lg text-white bg-green-600 hover:bg-green-700",children:"Approve"}),(0,e.jsx)("button",{onClick:()=>{S(C.id,"denied"),n()},className:"px-4 py-2 border border-transparent text-sm font-medium rounded-lg text-white bg-red-600 hover:bg-red-700",children:"Deny"})]})]})]})]})})]}))},As=Cs;function Ls(){const{currentUser:a}=he(),[o,i]=(0,s.useState)([]),[h,y]=(0,s.useState)(""),[m,w]=(0,s.useState)(!0),[p,j]=(0,s.useState)({}),[x,g]=(0,s.useState)({}),A=(0,s.useRef)(),C=(0,s.useRef)(),N=v=>{if(!v)return!1;const u=v.toDate?v.toDate():new Date(v);return(new Date-u)/(1e3*60)<2};(0,s.useEffect)(()=>{if(!a)return;(async()=>{try{const k=te(T,"users",a.uid);await ce(k,{isOnline:!0,lastActive:ue()})}catch(k){console.error("Error setting user online:",k)}})(),C.current=setInterval(async()=>{try{const k=te(T,"users",a.uid);await ce(k,{lastActive:ue()})}catch(k){console.error("Error updating lastActive:",k)}},3e4);const u=async()=>{try{const k=te(T,"users",a.uid);await ce(k,{isOnline:!1,lastActive:ue()})}catch(k){console.error("Error setting user offline:",k)}};return window.addEventListener("beforeunload",u),()=>{clearInterval(C.current),window.removeEventListener("beforeunload",u),a&&(async()=>{try{const S=te(T,"users",a.uid);await ce(S,{isOnline:!1,lastActive:ue()})}catch(S){console.error("Error setting user offline:",S)}})()}},[a]),(0,s.useEffect)(()=>{if(!a){w(!1);return}const v=ae(J(T,"messages"),xe("timestamp","asc"));return le(v,u=>{i(u.docs.map(k=>({id:k.id,...k.data()}))),w(!1)})},[a]),(0,s.useEffect)(()=>{if(a)return le(J(T,"users"),v=>{const u={},k={};v.forEach(S=>{const R=S.data();u[S.id]=R,N(R.lastActive)&&(k[S.id]={displayName:R.displayName||R.email?.split("@")[0]||"Unknown",isOnline:R.isOnline||!1,lastActive:R.lastActive})}),g(u),j(k)})},[a]);const U=async v=>{if(v.preventDefault(),!(!a||!h.trim()))try{await $t(J(T,"messages"),{text:h,userId:a.uid,userName:a.email?a.email.split("@")[0]:"Anonymous",timestamp:ue()}),y("")}catch(u){console.error("Error sending message:",u)}};(0,s.useEffect)(()=>{A.current?.scrollIntoView({behavior:"smooth"})},[o]);const I=v=>v?v.toDate().toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"}):"";return a?(0,e.jsxs)("div",{className:"flex flex-col  h-screen bg-gradient-to-b from-gray-50 to-gray-100 font-sans text-gray-800 max-w-4xl mx-auto w-full",children:[(0,e.jsx)("div",{className:"mx-4 mb-2 bg-white/70 backdrop-blur-md rounded-xl shadow-sm p-3",children:(0,e.jsxs)("div",{className:"flex flex-wrap gap-2",children:[(0,e.jsx)("div",{className:"w-2 h-2 bg-green-500 rounded-full"}),(0,e.jsxs)("span",{className:"text-xs text-gray-600",children:[Object.keys(p).length," online"]}),(0,e.jsx)("br",{}),(0,e.jsxs)("p",{className:"text-sm text-gray-500",children:[o.length," Messages"]})]})}),(0,e.jsxs)("div",{className:"flex-1 overflow-y-auto p-4 flex flex-col gap-4 max-w-full",children:[m?(0,e.jsx)("div",{className:"flex justify-center p-6",children:(0,e.jsxs)("div",{className:"flex gap-2",children:[(0,e.jsx)("div",{className:"w-2.5 h-2.5 bg-indigo-500 rounded-full animate-bounce"}),(0,e.jsx)("div",{className:"w-2.5 h-2.5 bg-indigo-500 rounded-full animate-bounce",style:{animationDelay:"0.16s"}}),(0,e.jsx)("div",{className:"w-2.5 h-2.5 bg-indigo-500 rounded-full animate-bounce",style:{animationDelay:"0.32s"}})]})}):o.length===0?(0,e.jsxs)("div",{className:"flex flex-col items-center justify-center text-gray-500 p-10 bg-white rounded-2xl shadow-lg m-5",children:[(0,e.jsx)("div",{className:"text-4xl mb-3 opacity-70",children:"ðŸ’¬"}),(0,e.jsx)("div",{className:"text-sm text-center max-w-xs",children:"No messages yet. Start a conversation!"})]}):o.map(v=>(0,e.jsxs)("div",{className:`flex ${v.userId===a.uid?"justify-end":"justify-start"} animate-fade-in`,children:[v.userId!==a.uid&&(0,e.jsxs)("div",{className:"relative",children:[(0,e.jsx)("div",{className:"w-9 h-9 rounded-full flex items-center justify-center bg-white text-indigo-600 font-bold flex-shrink-0 shadow-sm mr-2",children:v.userName?v.userName.charAt(0).toUpperCase():"U"}),(0,e.jsx)("div",{className:`absolute bottom-[60px] right-7 w-3.5 h-3.5 rounded-full border-2 border-white ${p[v.userId]?"bg-green-500":"bg-gray-400"}`,title:p[v.userId]?"Online":"Offline"})]}),(0,e.jsxs)("div",{className:`max-w-[72%] p-3 rounded-2xl relative shadow-md transition-all duration-300 hover:shadow-lg ${v.userId===a.uid?"bg-gradient-to-br from-indigo-50 to-indigo-100 border border-indigo-100 rounded-br-md":"bg-white border border-gray-200 rounded-bl-md"}`,children:[(0,e.jsx)("div",{className:"text-sm text-gray-800 leading-relaxed",children:v.text}),(0,e.jsx)("div",{className:"text-xs text-gray-400 text-right mt-2",children:I(v.timestamp)})]}),v.userId===a.uid&&(0,e.jsxs)("div",{className:"relative",children:[(0,e.jsx)("div",{className:"w-9 h-9 rounded-full flex items-center justify-center bg-gradient-to-br from-indigo-500 to-indigo-600 text-white font-bold flex-shrink-0 shadow-sm ml-2",children:v.userName?v.userName.charAt(0).toUpperCase():"U"}),(0,e.jsx)("div",{className:`absolute bottom-[60px] right-6 w-3.5 h-3.5 rounded-full border-2 border-white ${N(x[a?.uid]?.lastActive)?"bg-green-500":"bg-gray-400"}`,title:N(x[a?.uid]?.lastActive)?"Online":"Offline"})]})]},v.id)),(0,e.jsx)("div",{ref:A})]}),(0,e.jsxs)("form",{onSubmit:U,className:"flex items-center p-4 gap-3 sticky bottom-0 bg-white/70 backdrop-blur-md border-t border-gray-200",children:[(0,e.jsx)("div",{className:"flex-1 flex items-center bg-white p-2 pl-4 rounded-full shadow-md transition-all duration-300 focus-within:shadow-lg focus-within:border focus-within:border-indigo-500",children:(0,e.jsx)("input",{type:"text",className:"flex-1 border-0 outline-none p-2 bg-transparent text-sm text-gray-800",placeholder:"Type a message...",value:h,onChange:v=>y(v.target.value)})}),(0,e.jsx)("button",{type:"submit",className:"w-11 h-11 rounded-full flex items-center justify-center bg-gradient-to-br from-indigo-500 to-indigo-600 text-white border-none cursor-pointer shadow-md transition-all duration-300 hover:shadow-lg hover:-translate-y-0.5 active:translate-y-0 disabled:opacity-50 disabled:cursor-not-allowed disabled:transform-none",disabled:!h.trim(),children:(0,e.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor",className:"w-4.5 h-4.5",children:(0,e.jsx)("path",{d:"M3.478 2.404a.75.75 0 0 0-.926.941l2.432 7.905H13.5a.75.75 0 0 1 0 1.5H4.984l-2.432 7.905a.75.75 0 0 0 .926.94 60.519 60.519 0 0 0 18.445-8.986.75.75 0 0 0 0-1.218A60.517 60.517 0 0 0 3.478 2.404Z"})})})]})]}):(0,e.jsx)("div",{className:"flex flex-col h-screen bg-gradient-to-b from-gray-50 to-gray-100 items-center justify-center font-sans text-gray-800",children:(0,e.jsxs)("div",{className:"text-center p-6 bg-white rounded-2xl shadow-lg max-w-md",children:[(0,e.jsx)("h3",{className:"text-xl font-bold text-gray-900 mb-2",children:"Please log in to use chat"}),(0,e.jsx)("p",{className:"text-gray-600",children:"You need to be logged in to send and receive messages."})]})})}var Es=()=>(0,e.jsx)(e.Fragment,{children:(0,e.jsx)(Ls,{})}),Us=Es,Ps=()=>{const[a,o]=(0,s.useState)(!1),{currentUser:i}=he(),h=Et(),y=Ne(),{logout:m}=he(),w=async()=>{try{await m(),y("/login")}catch(x){console.error("Failed to log out",x)}};(0,s.useEffect)(()=>{const x=()=>{window.innerWidth>=1024&&o(!1)};return window.addEventListener("resize",x),()=>window.removeEventListener("resize",x)},[]),(0,s.useEffect)(()=>{const x=g=>{a&&!g.target.closest(".sidebar-content")&&!g.target.closest(".sidebar-toggle")&&o(!1)};return document.addEventListener("click",x),()=>document.removeEventListener("click",x)},[a]),(0,s.useEffect)(()=>{o(!1)},[h.pathname]);const p=[{name:"Dashboard",href:"/dashboard",icon:as},{name:"Deposits",href:"/deposits",icon:ss},{name:"loans",href:"/loans",icon:os},{name:"Chat",href:"/chat",icon:is},{name:"Users",href:"/users",icon:dt},{name:"Payback",href:"/payback",icon:Jt},{name:"Settings",href:"/settings",icon:He},{name:"Block users",href:"/admin-users",icon:He},{name:"Annual Reports",href:"/annual-reports",icon:Ae}],j=x=>h.pathname===x;return(0,e.jsxs)("div",{className:"flex h-screen w-screen max-w-full bg-gray-50",children:[(0,e.jsx)("div",{className:`fixed inset-y-0 left-0 z-50 w-64 bg-white shadow-lg transform ${a?"translate-x-0":"-translate-x-full"} transition-transform duration-300 ease-in-out lg:translate-x-0 lg:static lg:inset-0 sidebar-content`,children:(0,e.jsxs)("div",{className:"flex flex-col h-full",children:[(0,e.jsxs)("div",{className:"flex items-center justify-between h-16 px-6 border-b border-gray-200",children:[(0,e.jsxs)("div",{className:"flex items-center",children:[(0,e.jsx)("div",{className:"flex-shrink-0",children:(0,e.jsx)("div",{className:"w-8 h-8 bg-indigo-600 rounded-lg flex items-center justify-center",children:(0,e.jsx)("span",{className:"text-white font-bold",children:"MB"})})}),(0,e.jsx)("div",{className:"ml-3",children:(0,e.jsx)("h1",{className:"text-xl font-bold text-gray-900",children:"MoneyBox"})})]}),(0,e.jsx)("button",{onClick:()=>o(!1),className:"lg:hidden text-gray-500 hover:text-gray-700",children:(0,e.jsx)(ke,{size:20})})]}),(0,e.jsx)("nav",{className:"flex-1 px-4 py-6 overflow-y-auto",children:(0,e.jsx)("ul",{className:"space-y-1",children:p.map(x=>(0,e.jsx)("li",{children:(0,e.jsxs)(ze,{to:x.href,className:`flex items-center px-4 py-3 text-sm font-medium rounded-lg transition-all duration-200 ${j(x.href)?"bg-indigo-50 text-indigo-700":"text-gray-700 hover:bg-gray-100"}`,children:[(0,e.jsx)(x.icon,{className:"mr-3 h-5 w-5"}),x.name]})},x.name))})}),(0,e.jsxs)("div",{className:"px-4 py-6 border-t border-gray-200",children:[(0,e.jsxs)("div",{className:"flex items-center mb-4",children:[(0,e.jsx)("div",{className:"flex-shrink-0",children:(0,e.jsx)("div",{className:"w-10 h-10 bg-indigo-100 rounded-full flex items-center justify-center",children:(0,e.jsx)("div",{className:"w-11 h-11 rounded-full flex items-center justify-center bg-gradient-to-br from-indigo-500 to-indigo-600 text-white font-bold shadow-md",children:i?.email?.charAt(0).toUpperCase()||"U"})})}),(0,e.jsxs)("div",{className:"ml-3",children:[(0,e.jsxs)("p",{className:"text-sm font-medium text-gray-900",children:["Admin  is           ",i?.email?.slice(0,5).toUpperCase()||"U"]}),(0,e.jsx)("p",{className:"text-xs text-gray-500",children:i?.email?.slice(0,104).toLowerCase()||"U"})]})]}),(0,e.jsxs)("button",{onClick:w,className:"flex items-center w-full px-4 py-2 text-sm font-medium text-gray-700 hover:bg-gray-100 rounded-lg transition-colors duration-200",children:[(0,e.jsx)(Ke,{className:"mr-3 h-5 w-5"}),"Logout"]})]})]})}),(0,e.jsxs)("div",{className:"flex-1 flex flex-col overflow-hidden",children:[(0,e.jsx)("header",{className:"bg-white shadow-sm z-10",children:(0,e.jsxs)("div",{className:"flex items-center justify-between h-16 px-6",children:[(0,e.jsxs)("div",{className:"flex items-center",children:[(0,e.jsx)("button",{onClick:()=>o(!0),className:"lg:hidden text-gray-500 hover:text-gray-700 mr-4 sidebar-toggle",children:(0,e.jsx)(ds,{size:20})}),(0,e.jsxs)("h2",{className:"text-xl font-semibold text-gray-800",children:[h.pathname==="/dashboard"&&"ðŸ’° Dashboard",h.pathname==="/deposits"&&"ðŸ’° Deposits Overview",h.pathname==="/loans"&&"ðŸ’¸ loans Overview",h.pathname==="/users"&&"ðŸ‘¥ Users Overview",h.pathname==="/chat"&&"ðŸ‘¥ Users Overview"]})]}),(0,e.jsx)("div",{className:"flex items-center space-x-4",children:(0,e.jsxs)("button",{onClick:w,className:"flex items-center text-sm font-medium text-gray-700 hover:text-gray-900",children:[(0,e.jsx)(Ke,{className:"mr-2 h-5 w-5"}),"Logout"]})})]})}),(0,e.jsx)("main",{className:"flex-1 overflow-y-auto bg-gray-50 p-6",children:(0,e.jsx)("div",{className:"h-full w-full",children:(0,e.jsx)(At,{})})})]})]})},Fs=Ps,Ts=()=>{const[a,o]=(0,s.useState)([]),[i,h]=(0,s.useState)([]),[y,m]=(0,s.useState)(!0),[w,p]=(0,s.useState)(null),[j,x]=(0,s.useState)(""),[g,A]=(0,s.useState)("All"),[C,N]=(0,s.useState)({}),[U,I]=(0,s.useState)({});(0,s.useEffect)(()=>{const n=ae(J(T,"users")),r=le(n,c=>{const d=c.docs.map(F=>({id:F.id,...F.data()}));h(d)},c=>{console.error("Error loading users:",c),p("Failed to load users: "+c.message)});return()=>r()},[]),(0,s.useEffect)(()=>{const n=ae(J(T,"loans"),xe("timestamp","desc")),r=le(n,c=>{try{const d=c.docs.map(F=>({id:F.id,...F.data()})).map(F=>{const $=i.find(B=>B.uid===F.userId);return{...F,userName:$?$.fullName||"Unnamed User":"Unknown User"}});o(d),m(!1)}catch(d){console.error("Error merging loan data:",d),p("Error processing loan data: "+d.message),m(!1)}},c=>{console.error("Firestore error:",c),p("Failed to load loans: "+c.message),m(!1)});return()=>r()},[i]);const v=n=>{switch(n){case"accepted":return"bg-green-100 text-green-800";case"denied":return"bg-red-100 text-red-800";case"Pending":case"pending":return"bg-yellow-100 text-yellow-800";default:return"bg-gray-100 text-gray-800"}},u=n=>{if(!n)return"N/A";if(n.seconds){const r=new Date(n.seconds*1e3);return r.toLocaleDateString()+" "+r.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})}if(n.toDate){const r=n.toDate();return r.toLocaleDateString()+" "+r.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})}return n.toString()},k=(n,r)=>{const c=r.target.files[0];c&&I(d=>({...d,[n]:c}))},S=async n=>{const r="dlrxomdfh",c="Shop-preset",d=new FormData;return d.append("file",n),d.append("upload_preset",c),d.append("cloud_name",r),(await(await fetch(`https://api.cloudinary.com/v1_1/${r}/image/upload`,{method:"POST",body:d})).json()).secure_url},R=async n=>{if(window.confirm("Are you sure you want to accept this loan?")){if(!U[n]){alert("Please upload a receipt image before accepting the loan.");return}N(r=>({...r,[n]:!0}));try{const r=await S(U[n]),c=te(T,"loans",n);await ce(c,{status:"accepted",receiptUrl:r,acceptedAt:ue()}),I(d=>{const F={...d};return delete F[n],F})}catch(r){console.error("Error accepting loan:",r),p("Failed to accept loan: "+r.message)}finally{N(r=>{const c={...r};return delete c[n],c})}}},Y=async n=>{if(window.confirm("Are you sure you want to deny this loan?")){N(r=>({...r,[n]:!0}));try{const r=te(T,"loans",n);await ce(r,{status:"denied",deniedAt:ue()})}catch(r){console.error("Error denying loan:",r),p("Failed to deny loan: "+r.message)}finally{N(r=>{const c={...r};return delete c[n],c})}}},P=a.reduce((n,r)=>n+(parseFloat(r.amount)||0),0),_=a.filter(n=>n.status==="pending").length,q=a.filter(n=>n.status==="accepted").length,X=a.filter(n=>n.status==="denied").length,f=a.filter(n=>n.status==="accepted").reduce((n,r)=>n+(parseFloat(r.amount)||0),0),D=a.filter(n=>n.status==="denied").reduce((n,r)=>n+(parseFloat(r.amount)||0),0),E=a.filter(n=>{const r=n.userName?.toLowerCase().includes(j.toLowerCase())||n.userId?.toLowerCase().includes(j.toLowerCase())||n.message?.toLowerCase().includes(j.toLowerCase()),c=g==="All"||n.status===g;return r&&c});return y?(0,e.jsx)("div",{className:"flex items-center justify-center h-96",children:(0,e.jsxs)("div",{className:"text-center",children:[(0,e.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-indigo-600 mx-auto"}),(0,e.jsx)("p",{className:"mt-4 text-gray-600",children:"Loading loans..."})]})}):w?(0,e.jsxs)("div",{className:"bg-white rounded-2xl shadow-sm p-6 text-center",children:[(0,e.jsxs)("p",{className:"text-red-500",children:["Error: ",w]}),(0,e.jsx)("button",{onClick:()=>window.location.reload(),className:"mt-4 px-4 py-2 bg-indigo-600 text-white rounded-lg hover:bg-indigo-700 transition-colors duration-200",children:"Retry"})]}):(0,e.jsxs)("div",{className:"space-y-6",children:[(0,e.jsxs)("div",{className:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-3 xl:grid-cols-4 gap-6",children:[(0,e.jsx)("div",{className:"bg-white rounded-2xl shadow-sm p-6",children:(0,e.jsxs)("div",{className:"flex items-center justify-between",children:[(0,e.jsxs)("div",{children:[(0,e.jsx)("p",{className:"text-sm font-medium text-gray-500",children:"Total loans"}),(0,e.jsxs)("p",{className:"mt-2 text-3xl font-bold text-gray-900",children:["$",P.toFixed(2)]})]}),(0,e.jsx)("div",{className:"p-3 rounded-full bg-blue-100",children:(0,e.jsx)(Ae,{className:"h-6 w-6 text-blue-600"})})]})}),(0,e.jsx)("div",{className:"bg-white rounded-2xl shadow-sm p-6",children:(0,e.jsxs)("div",{className:"flex items-center justify-between",children:[(0,e.jsxs)("div",{children:[(0,e.jsx)("p",{className:"text-sm font-medium text-gray-500",children:"Pending loans"}),(0,e.jsx)("p",{className:"mt-2 text-3xl font-bold text-gray-900",children:_})]}),(0,e.jsx)("div",{className:"p-3 rounded-full bg-yellow-100",children:(0,e.jsx)(lt,{className:"h-6 w-6 text-yellow-600"})})]})}),(0,e.jsx)("div",{className:"bg-white rounded-2xl shadow-sm p-6",children:(0,e.jsxs)("div",{className:"flex items-center justify-between",children:[(0,e.jsxs)("div",{children:[(0,e.jsx)("p",{className:"text-sm font-medium text-gray-500",children:"Paid loans"}),(0,e.jsx)("p",{className:"mt-2 text-3xl font-bold text-gray-900",children:q})]}),(0,e.jsx)("div",{className:"p-3 rounded-full bg-green-100",children:(0,e.jsx)(es,{className:"h-6 w-6 text-green-600"})})]})}),(0,e.jsx)("div",{className:"bg-white rounded-2xl shadow-sm p-6",children:(0,e.jsxs)("div",{className:"flex items-center justify-between",children:[(0,e.jsxs)("div",{children:[(0,e.jsx)("p",{className:"text-sm font-medium text-gray-500",children:"Declined loans"}),(0,e.jsx)("p",{className:"mt-2 text-3xl font-bold text-gray-900",children:X})]}),(0,e.jsx)("div",{className:"p-3 rounded-full bg-red-100",children:(0,e.jsx)(je,{className:"h-6 w-6 text-red-600"})})]})}),(0,e.jsx)("div",{className:"bg-white rounded-2xl shadow-sm p-6",children:(0,e.jsxs)("div",{className:"flex items-center justify-between",children:[(0,e.jsxs)("div",{children:[(0,e.jsx)("p",{className:"text-sm font-medium text-gray-500",children:"Total Accepted Amount"}),(0,e.jsxs)("p",{className:"mt-2 text-3xl font-bold text-gray-900",children:["$",f.toFixed(2)]})]}),(0,e.jsx)("div",{className:"p-3 rounded-full bg-green-100",children:(0,e.jsx)($e,{className:"h-6 w-6 text-green-600"})})]})}),(0,e.jsx)("div",{className:"bg-white rounded-2xl shadow-sm p-6",children:(0,e.jsxs)("div",{className:"flex items-center justify-between",children:[(0,e.jsxs)("div",{children:[(0,e.jsx)("p",{className:"text-sm font-medium text-gray-500",children:"Total Declined Amount"}),(0,e.jsxs)("p",{className:"mt-2 text-3xl font-bold text-gray-900",children:["$",D.toFixed(2)]})]}),(0,e.jsx)("div",{className:"p-3 rounded-full bg-red-100",children:(0,e.jsx)(je,{className:"h-6 w-6 text-red-600"})})]})})]}),(0,e.jsx)("div",{className:"bg-white rounded-2xl shadow-sm p-6",children:(0,e.jsxs)("div",{className:"flex flex-col md:flex-row md:items-center md:justify-between space-y-4 md:space-y-0",children:[(0,e.jsx)("h2",{className:"text-lg font-medium text-gray-900",children:"Loans Records"}),(0,e.jsxs)("div",{className:"flex flex-col sm:flex-row space-y-2 sm:space-y-0 sm:space-x-4",children:[(0,e.jsxs)("div",{className:"relative",children:[(0,e.jsx)("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:(0,e.jsx)(be,{className:"h-5 w-5 text-gray-400"})}),(0,e.jsx)("input",{type:"text",placeholder:"Search by name, user ID or message...",className:"block w-full pl-10 pr-3 py-2 border border-gray-300 rounded-lg bg-gray-50 focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm",value:j,onChange:n=>x(n.target.value)})]}),(0,e.jsxs)("div",{className:"relative",children:[(0,e.jsxs)("select",{className:"block w-full pl-3 pr-10 py-2 text-base border-gray-300 focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm rounded-lg bg-gray-50",value:g,onChange:n=>A(n.target.value),children:[(0,e.jsx)("option",{value:"All",children:"All Statuses"}),(0,e.jsx)("option",{value:"Pending",children:"Pending"}),(0,e.jsx)("option",{value:"accepted",children:"Paid"}),(0,e.jsx)("option",{value:"denied",children:"Declined"})]}),(0,e.jsx)("div",{className:"absolute inset-y-0 right-0 flex items-center pr-3 pointer-events-none",children:(0,e.jsx)(ot,{className:"h-5 w-5 text-gray-400"})})]})]})]})}),(0,e.jsx)("div",{className:"bg-white rounded-2xl shadow-sm overflow-hidden",children:(0,e.jsx)("div",{className:"overflow-x-auto",children:(0,e.jsxs)("table",{className:"min-w-full divide-y divide-gray-200",children:[(0,e.jsx)("thead",{className:"bg-gray-50",children:(0,e.jsxs)("tr",{children:[(0,e.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"User Name"}),(0,e.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Amount"}),(0,e.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Status"}),(0,e.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Date"}),(0,e.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Actions"})]})}),(0,e.jsx)("tbody",{className:"bg-white divide-y divide-gray-200",children:E.length>0?E.map(n=>(0,e.jsxs)("tr",{className:"hover:bg-gray-50 transition-colors duration-150",children:[(0,e.jsxs)("td",{className:"px-6 py-4 whitespace-nowrap",children:[(0,e.jsx)("div",{className:"text-sm font-semibold text-gray-900",children:n.userName}),(0,e.jsxs)("div",{className:"text-xs text-gray-500 italic",children:["ID: ",n.userId]})]}),(0,e.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,e.jsxs)("div",{className:"text-sm font-semibold text-gray-900",children:["$",n.amount?parseFloat(n.amount).toFixed(2):"0.00"]})}),(0,e.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,e.jsx)("span",{className:`px-2 inline-flex text-xs leading-5 font-semibold rounded-full ${v(n.status)}`,children:n.status==="accepted"?"Paid":n.status||"Pending"})}),(0,e.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:u(n.timestamp)}),(0,e.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium",children:(0,e.jsxs)("div",{className:"flex items-center space-x-3",children:[n.status==="pending"?(0,e.jsxs)("div",{className:"flex flex-col space-y-2",children:[(0,e.jsxs)("div",{className:"flex flex-col space-y-2",children:[(0,e.jsx)("label",{className:"text-xs text-gray-500",children:"Upload receipt"}),(0,e.jsx)("input",{type:"file",accept:"image/*",onChange:r=>k(n.id,r),className:"block text-sm border rounded-lg p-1 cursor-pointer bg-gray-50"})]}),(0,e.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,e.jsx)("button",{disabled:!!C[n.id]||!U[n.id],onClick:()=>R(n.id),className:`px-3 py-1 rounded-lg text-sm font-medium transition-colors duration-200 ${!U[n.id]||C[n.id]?"opacity-50 cursor-not-allowed":"bg-green-600 text-white hover:bg-green-700"}`,children:C[n.id]?"Processing...":"Accept"}),(0,e.jsx)("button",{disabled:!!C[n.id],onClick:()=>Y(n.id),className:"px-3 py-1 bg-red-100 text-red-700 rounded-lg hover:bg-red-200 transition-colors duration-200 disabled:opacity-50",children:C[n.id]?"Processing...":"Deny"})]})]}):(0,e.jsx)("span",{className:"text-sm text-gray-500",children:n.status==="accepted"?"Paid":n.status}),n.imageUrl&&(0,e.jsx)("button",{onClick:()=>window.open(n.imageUrl,"_blank"),className:"text-indigo-600 hover:text-indigo-900 flex items-center",title:"View proof",children:(0,e.jsx)(ls,{className:"h-4 w-4"})})]})})]},n.id)):(0,e.jsx)("tr",{children:(0,e.jsx)("td",{colSpan:"5",className:"px-6 py-4 text-center text-sm text-gray-500",children:"No loans found."})})})]})})})]})},Is=Ts,Rs=()=>{const[a,o]=(0,s.useState)([]),[i,h]=(0,s.useState)(!0),[y,m]=(0,s.useState)(null),[w,p]=(0,s.useState)(""),[j,x]=(0,s.useState)(!1),[g,A]=(0,s.useState)(null),[C,N]=(0,s.useState)([]),[U,I]=(0,s.useState)([]),[v,u]=(0,s.useState)(!1),[k,S]=(0,s.useState)(!1),[R,Y]=(0,s.useState)(null),[P,_]=(0,s.useState)(null),[q,X]=(0,s.useState)({}),f=(0,s.useRef)(null),D=(0,s.useRef)(null);(0,s.useEffect)(()=>{if(!T){m("Firestore instance not available"),h(!1);return}const l=ae(J(T,"users"),xe("createdAt","desc")),z=le(l,M=>{try{const ee=M.docs.map(K=>({id:K.id,...K.data()}));o(ee),h(!1)}catch(ee){console.error("Error processing users snapshot:",ee),m("Failed to process users data"),h(!1)}},M=>{console.error("Error fetching users:",M),M.code==="permission-denied"?m("Permission denied. Check Firestore rules."):m("Failed to load users: "+(M.message||"Unknown error")),h(!1)});return()=>z()},[]),(0,s.useEffect)(()=>{if(f.current&&(f.current(),f.current=null),D.current&&(D.current(),D.current=null),!g){N([]),I([]);return}u(!0),Y(null);const l=ae(J(T,"deposits"),xe("timestamp","desc"));f.current=le(l,M=>{try{const ee=M.docs.map(K=>({id:K.id,...K.data()})).filter(K=>K.userId===g.uid);N(ee),u(!1)}catch(ee){console.error("Error processing deposits snapshot:",ee),Y("Failed to process deposits data"),u(!1)}},M=>{console.error("Error fetching deposits:",M),Y("Failed to load deposits: "+(M.message||"Unknown error")),u(!1)}),S(!0),_(null);const z=ae(J(T,"loans"),xe("timestamp","desc"));return D.current=le(z,M=>{try{const ee=M.docs.map(K=>({id:K.id,...K.data()})).filter(K=>K.userId===g.uid);I(ee),S(!1)}catch(ee){console.error("Error processing loans snapshot:",ee),_("Failed to process loans data"),S(!1)}},M=>{console.error("Error fetching loans:",M),_("Failed to load loans: "+(M.message||"Unknown error")),S(!1)}),()=>{f.current&&(f.current(),f.current=null),D.current&&(D.current(),D.current=null)}},[g]);const E=l=>{if(!l)return"N/A";if(l.seconds)return new Date(l.seconds*1e3).toLocaleString();if(l.toDate)return l.toDate().toLocaleString();try{return new Date(l).toLocaleString()}catch{return String(l)}},n=l=>{switch(l?.toLowerCase()){case"accepted":return"bg-green-100 text-green-800";case"denied":case"rejected":return"bg-red-100 text-red-800";case"pending":return"bg-yellow-100 text-yellow-800";default:return"bg-gray-100 text-gray-800"}},r=l=>{A(l),x(!0)},c=()=>{x(!1)},d=l=>{window.open(l,"_blank")},F=(l,z)=>{const M=document.createElement("a");M.href=l,M.download=z||"proof-image.jpg",document.body.appendChild(M),M.click(),document.body.removeChild(M)},$=C.reduce((l,z)=>l+(z.amount||0),0),B=U.reduce((l,z)=>l+(z.amount||0),0);C.filter(l=>l.status==="pending").length,C.filter(l=>l.status==="accepted").length,C.filter(l=>l.status==="denied"||l.status==="rejected").length,U.filter(l=>l.status==="pending").length,U.filter(l=>l.status==="accepted").length,U.filter(l=>l.status==="denied"||l.status==="rejected").length;const W=a.filter(l=>{const z=w.trim().toLowerCase();return z?(l.fullName||"").toLowerCase().includes(z)||(l.email||"").toLowerCase().includes(z)||(l.phoneNumber||"").toLowerCase().includes(z)||(l.uid||"").toLowerCase().includes(z):!0});return i?(0,e.jsx)("div",{className:"flex items-center justify-center h-64",children:(0,e.jsxs)("div",{className:"text-center",children:[(0,e.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-indigo-600 mx-auto"}),(0,e.jsx)("p",{className:"mt-4 text-gray-600",children:"Loading users..."})]})}):y?(0,e.jsxs)("div",{className:"bg-white rounded-2xl shadow-sm p-6 text-center",children:[(0,e.jsxs)("p",{className:"text-red-500",children:["Error: ",y]}),(0,e.jsx)("button",{onClick:()=>window.location.reload(),className:"mt-4 px-4 py-2 bg-indigo-600 text-white rounded-lg hover:bg-indigo-700 transition-colors duration-200",children:"Retry"})]}):(0,e.jsxs)("div",{className:"space-y-6",children:[(0,e.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6",children:[(0,e.jsx)("div",{className:"bg-white rounded-2xl shadow-sm p-6 md:col-span-1",children:(0,e.jsxs)("div",{className:"flex items-center justify-between",children:[(0,e.jsxs)("div",{children:[(0,e.jsx)("p",{className:"text-sm font-medium text-gray-500",children:"Total Users"}),(0,e.jsx)("p",{className:"mt-2 text-3xl font-bold text-gray-900",children:a.length})]}),(0,e.jsx)("div",{className:"p-3 rounded-full bg-green-100",children:(0,e.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6 text-green-600",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,e.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M17 20h5v-2a4 4 0 00-4-4h-1M9 20H4v-2a4 4 0 014-4h1m0-4a4 4 0 100-8 4 4 0 000 8z"})})})]})}),(0,e.jsx)("div",{className:"bg-white rounded-2xl shadow-sm p-6 md:col-span-3",children:(0,e.jsxs)("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between space-y-4 sm:space-y-0",children:[(0,e.jsx)("h2",{className:"text-lg font-medium text-gray-900",children:"User Records"}),(0,e.jsx)("div",{className:"flex items-center w-full sm:w-64",children:(0,e.jsxs)("div",{className:"relative w-full",children:[(0,e.jsx)("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:(0,e.jsx)(be,{className:"h-5 w-5 text-gray-400"})}),(0,e.jsx)("input",{type:"text",placeholder:"Search users...",className:"block w-full pl-10 pr-3 py-2 border border-gray-300 rounded-lg bg-gray-50 focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm",value:w,onChange:l=>p(l.target.value)})]})})]})})]}),(0,e.jsx)("div",{className:"bg-white rounded-2xl shadow-sm overflow-hidden",children:(0,e.jsx)("div",{className:"overflow-x-auto",children:(0,e.jsxs)("table",{className:"min-w-full divide-y divide-gray-200",children:[(0,e.jsx)("thead",{className:"bg-gray-50",children:(0,e.jsxs)("tr",{children:[(0,e.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"User"}),(0,e.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Email"}),(0,e.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Phone"}),(0,e.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Gender"}),(0,e.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Age"}),(0,e.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Joined"})]})}),(0,e.jsx)("tbody",{className:"bg-white divide-y divide-gray-200",children:W.length>0?W.map(l=>(0,e.jsxs)("tr",{className:"hover:bg-gray-50 transition-colors duration-150 cursor-pointer",onClick:()=>r(l),children:[(0,e.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,e.jsxs)("div",{className:"flex items-center",children:[l.imageUrl?(0,e.jsx)("img",{src:l.imageUrl,alt:l.fullName||"avatar",className:"h-10 w-10 rounded-full object-cover",onError:z=>{z.target.style.display="none"}}):(0,e.jsx)("div",{className:"h-10 w-10 rounded-full bg-gray-200 flex items-center justify-center text-sm font-medium text-gray-700",children:(l.fullName||"U").split(" ").map(z=>z[0]).slice(0,2).join("").toUpperCase()}),(0,e.jsxs)("div",{className:"ml-3",children:[(0,e.jsx)("div",{className:"text-sm font-medium text-gray-900",children:l.fullName||"No name"}),(0,e.jsx)("div",{className:"text-xs text-gray-500",children:l.uid||""})]})]})}),(0,e.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:l.email||"N/A"}),(0,e.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:l.phoneNumber||"N/A"}),(0,e.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500 capitalize",children:l.gender||"N/A"}),(0,e.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:l.age||"N/A"}),(0,e.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:E(l.createdAt)})]},l.id)):(0,e.jsx)("tr",{children:(0,e.jsx)("td",{colSpan:"6",className:"px-6 py-4 text-center text-sm text-gray-500",children:"No users found."})})})]})})}),j&&g&&(0,e.jsx)("div",{className:"fixed inset-0 z-50 overflow-auto bg-black bg-opacity-50 flex items-center justify-center p-4",children:(0,e.jsxs)("div",{className:"bg-white rounded-xl shadow-xl max-w-6xl w-full max-h-[90vh] overflow-auto",children:[(0,e.jsxs)("div",{className:"sticky top-0 bg-white border-b border-gray-200 px-6 py-4 flex justify-between items-center",children:[(0,e.jsxs)("h2",{className:"text-xl font-semibold text-gray-900",children:["User Details: ",g.fullName]}),(0,e.jsx)("button",{onClick:c,className:"p-1 rounded-full hover:bg-gray-100 transition-colors",children:(0,e.jsx)(ke,{className:"h-5 w-5 text-gray-500"})})]}),(0,e.jsxs)("div",{className:"p-6",children:[(0,e.jsxs)("div",{className:"bg-gray-50 rounded-lg p-4 mb-6",children:[(0,e.jsxs)("div",{className:"flex items-center mb-4",children:[g.imageUrl?(0,e.jsx)("img",{src:g.imageUrl,alt:g.fullName||"avatar",className:"h-16 w-16 rounded-full object-cover mr-4"}):(0,e.jsx)("div",{className:"h-16 w-16 rounded-full bg-gray-200 flex items-center justify-center text-xl font-medium text-gray-700 mr-4",children:(g.fullName||"U").split(" ").map(l=>l[0]).slice(0,2).join("").toUpperCase()}),(0,e.jsxs)("div",{children:[(0,e.jsx)("h3",{className:"text-lg font-medium text-gray-900",children:g.fullName||"No name"}),(0,e.jsxs)("p",{className:"text-sm text-gray-500",children:["ID: ",g.uid||"N/A"]})]})]}),(0,e.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,e.jsxs)("div",{children:[(0,e.jsx)("p",{className:"text-sm font-medium text-gray-500",children:"Email"}),(0,e.jsx)("p",{className:"text-sm text-gray-900",children:g.email||"N/A"})]}),(0,e.jsxs)("div",{children:[(0,e.jsx)("p",{className:"text-sm font-medium text-gray-500",children:"Phone Number"}),(0,e.jsx)("p",{className:"text-sm text-gray-900",children:g.phoneNumber||"N/A"})]}),(0,e.jsxs)("div",{children:[(0,e.jsx)("p",{className:"text-sm font-medium text-gray-500",children:"MoMo Number"}),(0,e.jsx)("p",{className:"text-sm text-gray-900",children:g.momoNumber||"N/A"})]}),(0,e.jsxs)("div",{children:[(0,e.jsx)("p",{className:"text-sm font-medium text-gray-500",children:"Credit card Number"}),(0,e.jsx)("p",{className:"text-sm text-gray-900",children:g.creditCardNumber||"N/A"})]}),(0,e.jsxs)("div",{children:[(0,e.jsx)("p",{className:"text-sm font-medium text-gray-500",children:"Gender"}),(0,e.jsx)("p",{className:"text-sm text-gray-900 capitalize",children:g.gender||"N/A"})]}),(0,e.jsxs)("div",{children:[(0,e.jsx)("p",{className:"text-sm font-medium text-gray-500",children:"Age"}),(0,e.jsx)("p",{className:"text-sm text-gray-900",children:g.age||"N/A"})]}),(0,e.jsxs)("div",{children:[(0,e.jsx)("p",{className:"text-sm font-medium text-gray-500",children:"Joined Date"}),(0,e.jsx)("p",{className:"text-sm text-gray-900",children:E(g.createdAt)})]})]})]}),(0,e.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6 mb-6",children:[(0,e.jsxs)("div",{className:"bg-white rounded-lg shadow p-4",children:[(0,e.jsxs)("div",{className:"flex items-center mb-4",children:[(0,e.jsx)("div",{className:"p-2 rounded-full bg-green-100 mr-3",children:(0,e.jsx)(Ce,{className:"h-6 w-6 text-green-600"})}),(0,e.jsx)("h3",{className:"text-lg font-medium text-gray-900",children:"Deposits Summary"})]}),(0,e.jsx)("div",{className:"space-y-3",children:(0,e.jsxs)("div",{className:"flex justify-between",children:[(0,e.jsx)("span",{className:"text-sm text-gray-500",children:"Total Amount:"}),(0,e.jsxs)("span",{className:"text-sm font-medium text-gray-900",children:["$",$.toFixed(2)]})]})})]}),(0,e.jsxs)("div",{className:"bg-white rounded-lg shadow p-4",children:[(0,e.jsxs)("div",{className:"flex items-center mb-4",children:[(0,e.jsx)("div",{className:"p-2 rounded-full bg-blue-100 mr-3",children:(0,e.jsx)(rs,{className:"h-6 w-6 text-blue-600"})}),(0,e.jsx)("h3",{className:"text-lg font-medium text-gray-900",children:"Loans Summary"})]}),(0,e.jsx)("div",{className:"space-y-3",children:(0,e.jsxs)("div",{className:"flex justify-between",children:[(0,e.jsx)("span",{className:"text-sm text-gray-500",children:"Total Amount:"}),(0,e.jsxs)("span",{className:"text-sm font-medium text-gray-900",children:["$",B.toFixed(2)]})]})})]})]}),(0,e.jsxs)("div",{className:"mb-6",children:[(0,e.jsx)("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:"Deposits"}),v?(0,e.jsx)("div",{className:"flex justify-center py-4",children:(0,e.jsx)("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-indigo-600"})}):R?(0,e.jsx)("div",{className:"bg-red-50 p-4 rounded-md",children:(0,e.jsx)("p",{className:"text-sm text-red-800",children:R})}):C.length>0?(0,e.jsx)("div",{className:"overflow-x-auto",children:(0,e.jsxs)("table",{className:"min-w-full divide-y divide-gray-200",children:[(0,e.jsx)("thead",{className:"bg-gray-50",children:(0,e.jsxs)("tr",{children:[(0,e.jsx)("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Amount"}),(0,e.jsx)("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Status"}),(0,e.jsx)("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Date"}),(0,e.jsx)("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Message"}),(0,e.jsx)("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Proof"})]})}),(0,e.jsx)("tbody",{className:"bg-white divide-y divide-gray-200",children:C.map(l=>(0,e.jsxs)("tr",{children:[(0,e.jsxs)("td",{className:"px-4 py-3 whitespace-nowrap text-sm text-gray-900",children:["$",l.amount||"0"]}),(0,e.jsx)("td",{className:"px-4 py-3 whitespace-nowrap",children:(0,e.jsx)("span",{className:`px-2 inline-flex text-xs leading-5 font-semibold rounded-full ${n(l.status)}`,children:l.status||"Unknown"})}),(0,e.jsx)("td",{className:"px-4 py-3 whitespace-nowrap text-sm text-gray-500",children:E(l.timestamp)}),(0,e.jsx)("td",{className:"px-4 py-3 text-sm text-gray-900 max-w-xs truncate",title:l.message,children:l.message||"N/A"}),(0,e.jsx)("td",{className:"px-4 py-3 whitespace-nowrap text-sm text-gray-500",children:l.proofImage?(0,e.jsxs)("div",{className:"flex space-x-2",children:[(0,e.jsx)("button",{onClick:()=>d(l.proofImage),className:"text-indigo-600 hover:text-indigo-900",title:"View",children:(0,e.jsx)(Oe,{className:"h-5 w-5"})}),(0,e.jsx)("button",{onClick:()=>F(l.proofImage,`deposit-proof-${l.id}.jpg`),className:"text-indigo-600 hover:text-indigo-900",title:"Download",children:(0,e.jsx)(it,{className:"h-5 w-5"})})]}):"N/A"})]},l.id))})]})}):(0,e.jsx)("div",{className:"text-center py-4 text-sm text-gray-500",children:"No deposits found."})]}),(0,e.jsxs)("div",{children:[(0,e.jsx)("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:"Loans"}),k?(0,e.jsx)("div",{className:"flex justify-center py-4",children:(0,e.jsx)("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-indigo-600"})}):P?(0,e.jsx)("div",{className:"bg-red-50 p-4 rounded-md",children:(0,e.jsx)("p",{className:"text-sm text-red-800",children:P})}):U.length>0?(0,e.jsx)("div",{className:"overflow-x-auto",children:(0,e.jsxs)("table",{className:"min-w-full divide-y divide-gray-200",children:[(0,e.jsx)("thead",{className:"bg-gray-50",children:(0,e.jsxs)("tr",{children:[(0,e.jsx)("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Amount"}),(0,e.jsx)("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Status"}),(0,e.jsx)("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Date"}),(0,e.jsx)("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Reason"}),(0,e.jsx)("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Approved By"})]})}),(0,e.jsx)("tbody",{className:"bg-white divide-y divide-gray-200",children:U.map(l=>(0,e.jsxs)("tr",{children:[(0,e.jsxs)("td",{className:"px-4 py-3 whitespace-nowrap text-sm text-gray-900",children:["$",l.amount||"0"]}),(0,e.jsx)("td",{className:"px-4 py-3 whitespace-nowrap",children:(0,e.jsx)("span",{className:`px-2 inline-flex text-xs leading-5 font-semibold rounded-full ${n(l.status)}`,children:l.status||"Unknown"})}),(0,e.jsx)("td",{className:"px-4 py-3 whitespace-nowrap text-sm text-gray-500",children:E(l.timestamp)}),(0,e.jsx)("td",{className:"px-4 py-3 text-sm text-gray-900 max-w-xs truncate",title:l.reason,children:l.reason||"N/A"}),(0,e.jsx)("td",{className:"px-4 py-3 whitespace-nowrap text-sm text-gray-500",children:l.approvedBy||"N/A"})]},l.id))})]})}):(0,e.jsx)("div",{className:"text-center py-4 text-sm text-gray-500",children:"No loans found."})]})]})]})})]})},Ms=Rs,$s=()=>{const[a,o]=(0,s.useState)("10.00"),[i,h]=(0,s.useState)(!0),[y,m]=(0,s.useState)(!1),[w,p]=(0,s.useState)(null),[j,x]=(0,s.useState)("success"),[g,A]=(0,s.useState)([]),[C,N]=(0,s.useState)(!1),[U,I]=(0,s.useState)(null);(0,s.useEffect)(()=>{(async()=>{try{const k=ae(J(T,"interest"),xe("timestamp","desc"),Mt(10)),S=await fe(k);if(S.empty)o("10.00");else{const R=S.docs[0];o(R.data().interest.toFixed(2)),I(R.id);const Y=S.docs.map(P=>({date:new Date(P.data().timestamp?.toDate()||Date.now()).toLocaleDateString(),rate:parseFloat(P.data().interest)})).reverse();A(Y)}}catch(k){console.error("Error fetching interest:",k),p("Failed to load interest rate"),x("error"),setTimeout(()=>p(null),3e3)}finally{h(!1)}})()},[]);const v=async()=>{if(isNaN(a)||a<1||a>100){p("Please enter a valid interest rate between 1% and 100%"),x("error"),setTimeout(()=>p(null),3e3);return}m(!0);try{const u=new Date;if(U){const k=te(T,"interest",U);await ce(k,{interest:Number(a),timestamp:u})}else await nt(te(T,"interest","globalRate"),{interest:Number(a),timestamp:u}),I("globalRate");p("Interest rate updated successfully!"),x("success"),A(k=>[...k.slice(-9),{date:u.toLocaleDateString(),rate:Number(a)}])}catch(u){console.error("Error updating interest:",u),p("Failed to update interest rate"),x("error")}finally{m(!1),setTimeout(()=>p(null),3e3)}};return i?(0,e.jsx)("div",{className:"flex justify-center items-center min-h-screen px-4",children:(0,e.jsxs)("div",{className:"bg-white dark:bg-gray-800 rounded-2xl shadow-lg p-10 w-full max-w-md text-center",children:[(0,e.jsx)("div",{className:"inline-block animate-spin rounded-full h-8 w-8 border-t-2 border-b-2 border-blue-500"}),(0,e.jsx)("p",{className:"mt-4 text-gray-600 dark:text-gray-300",children:"Loading interest rate..."})]})}):(0,e.jsxs)("div",{className:"flex justify-center items-center min-h-screen px-4 bg-gray-50 dark:bg-gray-900",children:[(0,e.jsxs)("div",{className:"bg-white dark:bg-gray-800 rounded-2xl shadow-lg p-4 sm:p-6 md:p-10 w-full max-w-md",children:[(0,e.jsx)("h2",{className:"text-xl sm:text-2xl font-bold text-gray-800 dark:text-gray-100 mb-6 text-center",children:"Interest Rate Settings"}),(0,e.jsxs)("div",{className:"mb-6",children:[(0,e.jsx)("label",{className:"block text-sm font-medium text-gray-600 dark:text-gray-300 mb-2",children:"Current Interest Rate (%)"}),(0,e.jsxs)("div",{className:"relative",children:[(0,e.jsx)("input",{type:"number",step:"0.01",min:"1",max:"100",value:a,onChange:u=>o(u.target.value),className:"border border-gray-300 dark:border-gray-700 rounded-lg p-3 w-full focus:ring-2 focus:ring-blue-500 outline-none pr-12",disabled:y,placeholder:"Enter interest rate (1â€“100)"}),(0,e.jsx)("div",{className:"absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-500",children:"%"})]}),(0,e.jsx)("p",{className:"text-xs text-gray-500 mt-1",children:"Enter as a percentage (e.g., 5 for 5%)"})]}),(0,e.jsx)("button",{onClick:v,disabled:y,className:"bg-blue-600 hover:bg-blue-700 text-white font-semibold py-2 px-4 rounded-lg transition duration-200 w-full disabled:opacity-50 flex items-center justify-center text-sm sm:text-base",children:y?(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)("div",{className:"animate-spin rounded-full h-4 w-4 border-t-2 border-b-2 border-white mr-2"}),"Saving..."]}):"Save Changes"}),(0,e.jsx)("div",{className:"mt-6 text-center",children:(0,e.jsxs)("button",{onClick:()=>N(!C),className:"text-blue-600 dark:text-blue-400 text-sm font-medium hover:underline",children:[C?"Hide":"Show"," Rate History"]})}),C&&g.length>0&&(0,e.jsxs)("div",{className:"mt-6 pt-6 border-t border-gray-200 dark:border-gray-700",children:[(0,e.jsx)("h3",{className:"text-lg font-semibold text-gray-700 dark:text-gray-300 mb-4",children:"Interest Rate History"}),(0,e.jsx)("div",{className:"h-48",children:(0,e.jsx)(Te,{width:"100%",height:"100%",children:(0,e.jsxs)(at,{data:g,children:[(0,e.jsx)(Ie,{strokeDasharray:"3 3",stroke:"#e0e0e0"}),(0,e.jsx)(Fe,{dataKey:"date",tick:{fontSize:12}}),(0,e.jsx)(Re,{tick:{fontSize:12},domain:["dataMin - 0.5","dataMax + 0.5"]}),(0,e.jsx)(Pe,{formatter:u=>`${u.toFixed(2)}%`,contentStyle:{backgroundColor:"rgba(255, 255, 255, 0.9)",border:"1px solid #ccc",borderRadius:"4px"}}),(0,e.jsx)(Ue,{type:"monotone",dataKey:"rate",stroke:"#3b82f6",strokeWidth:2,dot:{fill:"#3b82f6",r:4},activeDot:{r:6}})]})})})]})]}),w&&(0,e.jsx)("div",{className:`fixed top-5 left-1/2 transform -translate-x-1/2 px-6 py-3 rounded-lg text-white font-semibold shadow-md transition-all duration-300 ${j==="success"?"bg-green-500":"bg-red-500"}`,children:w})]})},zs=$s;gs();var Ee=Le(hs()),Os=(a,o)=>{const i=new fs({orientation:"portrait",unit:"mm",format:"a4"}),h=i.internal.pageSize.getWidth(),y=i.internal.pageSize.getHeight(),m=20;h-m*2,i.setFont("helvetica");const w=u=>u?(u.toDate?u.toDate():new Date(u)).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"}):"N/A",p=u=>`$${u.toFixed(2)}`,j=u=>u==="approved"?[0,128,0]:[255,0,0],x=u=>u==="approved"?"PAID":u?u.toUpperCase():"UNPAID",g=()=>{i.setFillColor(41,98,255),i.rect(0,0,h,30,"F"),i.setTextColor(255,255,255),i.setFontSize(20),i.setFont("helvetica","bold"),i.text("Annual User Reports",h/2,20,{align:"center"}),i.setFontSize(14),i.setFont("helvetica","normal"),i.text(`${o}`,h/2,26,{align:"center"}),i.setTextColor(0,0,0)},A=u=>{const k=y-10;i.setFontSize(8),i.setTextColor(100,100,100),i.text(`Page ${u}`,h/2,k,{align:"center"})},C=()=>{g(),i.setFontSize(28),i.setTextColor(41,98,255),i.text("Annual User Reports",h/2,100,{align:"center"}),i.setFontSize(22),i.text(`${o}`,h/2,115,{align:"center"}),i.setFontSize(12),i.setTextColor(100,100,100);const u=new Date().toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"});i.text(`Generated on ${u}`,h/2,130,{align:"center"}),i.setTextColor(0,0,0),i.setFontSize(14),i.setFont("helvetica","bold"),i.text("Summary Statistics",m,160),i.setFont("helvetica","normal"),i.setFontSize(12);const k=a.length,S=a.reduce((_,q)=>_+q.totalDeposits,0),R=a.reduce((_,q)=>_+q.totalLoans,0),Y=a.reduce((_,q)=>_+q.paidLoansCount,0),P=a.reduce((_,q)=>_+q.unpaidLoansCount,0);i.text(`Total Users: ${k}`,m,175),i.text(`Total Deposits: ${p(S)}`,m,185),i.text(`Total Loans: ${p(R)}`,m,195),i.text(`Total Paid Loans: ${Y}`,m,205),i.text(`Total Unpaid Loans: ${P}`,m,215),A(1),i.addPage()};let N=0;const U=()=>{g();const u=[[{content:"User Name",dataKey:"name"}],[{content:"Total Deposits ($)",dataKey:"totalDeposits"}],[{content:"Paid Loans",dataKey:"paidLoansCount"}],[{content:"Unpaid Loans",dataKey:"unpaidLoansCount"}],[{content:"Total Loans ($)",dataKey:"totalLoans"}]],k=a.map(S=>[S.user.name||"Unknown User",p(S.totalDeposits),S.paidLoansCount,S.unpaidLoansCount,p(S.totalLoans)]);(0,Ee.default)(i,{head:u,body:k,startY:40,theme:"grid",styles:{font:"helvetica",fontSize:10,cellPadding:5},headStyles:{fillColor:[41,98,255],textColor:255,fontStyle:"bold"},alternateRowStyles:{fillColor:[245,245,245]},margin:{left:20,right:20},didDrawPage:S=>{N=S.cursor.y}}),N=i.lastAutoTable.finalY+10,A(i.internal.getNumberOfPages())},I=u=>y-N-20<u?(i.addPage(),g(),N=40,A(i.internal.getNumberOfPages()),!0):!1,v=(u,k=!1)=>{const S=60+u.deposits.length*10+u.loans.length*10;if(I(S),i.setFontSize(16),i.setFont("helvetica","bold"),i.setTextColor(41,98,255),i.text(u.user.name||"Unknown User",m,N),N+=10,i.setFontSize(12),i.setFont("helvetica","normal"),i.setTextColor(0,0,0),i.text(`Email: ${u.user.email||"N/A"}`,m,N),N+=10,i.text(`Phone: ${u.user.phone||"N/A"}`,m,N),N+=15,u.deposits.length>0){const R=[[{content:"Amount",dataKey:"amount"}],[{content:"Date",dataKey:"date"}]],Y=u.deposits.map(P=>[p(P.amount),w(P.timestamp)]);I(30),(0,Ee.default)(i,{head:R,body:Y,startY:N,theme:"grid",styles:{font:"helvetica",fontSize:10,cellPadding:5},headStyles:{fillColor:[75,192,192],textColor:255,fontStyle:"bold"},margin:{left:m,right:m},didDrawPage:P=>{N=P.cursor.y}}),N=i.lastAutoTable.finalY+10}else I(20),i.setFontSize(10),i.setTextColor(100,100,100),i.text("No deposits found",m,N),i.setTextColor(0,0,0),N+=10;if(u.loans.length>0){const R=[[{content:"Amount",dataKey:"amount"}],[{content:"Date",dataKey:"date"}],[{content:"Status",dataKey:"status"}]],Y=u.loans.map(P=>[p(P.amount),w(P.timestamp),x(P.paymentStatus)]);I(30),(0,Ee.default)(i,{head:R,body:Y,startY:N,theme:"grid",styles:{font:"helvetica",fontSize:10,cellPadding:5},headStyles:{fillColor:[255,99,132],textColor:255,fontStyle:"bold"},didDrawCell:P=>{if(P.section==="body"&&P.column.index===2){const _=P.row.index,q=u.loans[_];if(q){const X=j(q.paymentStatus);i.setTextColor(X[0],X[1],X[2])}}},didDrawPage:P=>{N=P.cursor.y},margin:{left:m,right:m}}),N=i.lastAutoTable.finalY+15}else I(20),i.setFontSize(10),i.setTextColor(100,100,100),i.text("No loans found",m,N),i.setTextColor(0,0,0),N+=15};try{C(),U(),a.length>0&&(i.addPage(),g(),N=40),a.forEach((S,R)=>{v(S,R===0)});const u=i.internal.getNumberOfPages();for(let S=1;S<=u;S++)i.setPage(S),A(S);const k=`annual-reports-${o}.pdf`;return i.save(k),{success:!0,filename:k}}catch(u){return console.error("Error generating PDF:",u),{success:!1,error:u.message}}},Ys=Os;Vt.register(Wt,Ot,qt,_t,Yt,Bt,Kt);var Qe=a=>ps(new Date(a,0,1)),Je=a=>xs(new Date(a,0,1)),ut=(a,o)=>new Date(a,o-1,1),ht=(a,o)=>new Date(a,o,0),Xe=a=>{if(!a)return"N/A";const o=a.toDate?a.toDate():new Date(a);return ct(o,"MMM dd, yyyy")},_s=(a,o)=>{const i=a.reduce((w,p)=>w+p.amount,0),h=o.reduce((w,p)=>w+p.amount,0),y=o.filter(w=>w.paymentStatus==="approved").length,m=o.filter(w=>w.paymentStatus!=="approved").length;return{totalDeposits:i,totalLoans:h,paidLoansCount:y,unpaidLoansCount:m}},Bs=(a,o)=>{if(!o.trim())return a;const i=o.toLowerCase();return a.filter(h=>h.user?.name?.toLowerCase().includes(i)||h.user?.email?.toLowerCase().includes(i)||h.user?.phone?.toLowerCase().includes(i))},Ws=(a,o)=>{const i=["User","Total Deposits","Total Loans","Paid Loans","Unpaid Loans"],h=a.map(j=>[j.user.name,j.totalDeposits,j.totalLoans,j.paidLoansCount,j.unpaidLoansCount]);let y=i.join(",")+`
`;h.forEach(j=>{y+=j.join(",")+`
`});const m=new Blob([y],{type:"text/csv;charset=utf-8;"}),w=URL.createObjectURL(m),p=document.createElement("a");p.setAttribute("href",w),p.setAttribute("download",o),p.style.visibility="hidden",document.body.appendChild(p),p.click(),document.body.removeChild(p)},et=(a,o,i)=>{const h=[];for(let y=1;y<=12;y++){const m=ut(i,y),w=ht(i,y),p=a.filter(x=>{const g=x.timestamp.toDate?x.timestamp.toDate():new Date(x.timestamp);return g>=m&&g<=w}),j=o.filter(x=>{const g=x.timestamp.toDate?x.timestamp.toDate():new Date(x.timestamp);return g>=m&&g<=w});h.push({month:ct(m,"MMM"),deposits:p.reduce((x,g)=>x+g.amount,0),loans:j.reduce((x,g)=>x+g.amount,0)})}return h},qs=a=>a==="approved"?{text:"PAID",className:"bg-green-100 text-green-800"}:{text:a?a.toUpperCase():"UNPAID",className:"bg-red-100 text-red-800"},tt=({data:a,columns:o,itemsPerPage:i=10})=>{const[h,y]=(0,s.useState)(1),m=Math.ceil(a.length/i),w=(h-1)*i,p=w+i,j=a.slice(w,p);return(0,e.jsxs)("div",{children:[(0,e.jsx)("div",{className:"overflow-x-auto",children:(0,e.jsxs)("table",{className:"min-w-full divide-y divide-gray-200",children:[(0,e.jsx)("thead",{className:"bg-gray-50",children:(0,e.jsx)("tr",{children:o.map((x,g)=>(0,e.jsx)("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:x.header},g))})}),(0,e.jsx)("tbody",{className:"bg-white divide-y divide-gray-200",children:j.map((x,g)=>(0,e.jsx)("tr",{children:o.map((A,C)=>(0,e.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:A.render?A.render(x):x[A.accessor]},C))},g))})]})}),m>1&&(0,e.jsxs)("div",{className:"px-6 py-3 flex items-center justify-between border-t border-gray-200",children:[(0,e.jsxs)("div",{className:"flex-1 flex justify-between sm:hidden",children:[(0,e.jsx)("button",{onClick:()=>y(x=>Math.max(x-1,1)),disabled:h===1,className:"relative inline-flex items-center px-4 py-2 border border-gray-300 text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50",children:"Previous"}),(0,e.jsx)("button",{onClick:()=>y(x=>Math.min(x+1,m)),disabled:h===m,className:"ml-3 relative inline-flex items-center px-4 py-2 border border-gray-300 text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50",children:"Next"})]}),(0,e.jsxs)("div",{className:"hidden sm:flex-1 sm:flex sm:items-center sm:justify-between",children:[(0,e.jsx)("div",{children:(0,e.jsxs)("p",{className:"text-sm text-gray-700",children:["Showing ",(0,e.jsx)("span",{className:"font-medium",children:w+1})," to"," ",(0,e.jsx)("span",{className:"font-medium",children:Math.min(p,a.length)})," of"," ",(0,e.jsx)("span",{className:"font-medium",children:a.length})," results"]})}),(0,e.jsx)("div",{children:(0,e.jsxs)("nav",{className:"relative z-0 inline-flex rounded-md shadow-sm -space-x-px","aria-label":"Pagination",children:[(0,e.jsx)("button",{onClick:()=>y(x=>Math.max(x-1,1)),disabled:h===1,className:"relative inline-flex items-center px-2 py-2 rounded-l-md border border-gray-300 bg-white text-sm font-medium text-gray-500 hover:bg-gray-50",children:"Previous"}),Array.from({length:m},(x,g)=>g+1).map(x=>(0,e.jsx)("button",{onClick:()=>y(x),className:`relative inline-flex items-center px-4 py-2 border text-sm font-medium ${h===x?"z-10 bg-blue-50 border-blue-500 text-blue-600":"bg-white border-gray-300 text-gray-500 hover:bg-gray-50"}`,children:x},x)),(0,e.jsx)("button",{onClick:()=>y(x=>Math.min(x+1,m)),disabled:h===m,className:"relative inline-flex items-center px-2 py-2 rounded-r-md border border-gray-300 bg-white text-sm font-medium text-gray-500 hover:bg-gray-50",children:"Next"})]})})]})]})]})},Vs=({isOpen:a,onClose:o,user:i,deposits:h,loans:y})=>{if(!a)return null;const m=[{header:"Amount",accessor:"amount",render:p=>`$${p.amount.toFixed(2)}`},{header:"Date",accessor:"timestamp",render:p=>Xe(p.timestamp)}],w=[{header:"Amount",accessor:"amount",render:p=>`$${p.amount.toFixed(2)}`},{header:"Date",accessor:"timestamp",render:p=>Xe(p.timestamp)},{header:"Status",accessor:"paymentStatus",render:p=>{const j=qs(p.paymentStatus);return(0,e.jsx)("span",{className:`px-2 inline-flex text-xs leading-5 font-semibold rounded-full ${j.className}`,children:j.text})}}];return(0,e.jsx)("div",{className:"fixed inset-0 z-50 overflow-y-auto",children:(0,e.jsxs)("div",{className:"flex items-center justify-center min-h-screen pt-4 px-4 pb-20 text-center sm:block sm:p-0",children:[(0,e.jsx)("div",{className:"fixed inset-0 transition-opacity","aria-hidden":"true",children:(0,e.jsx)("div",{className:"absolute inset-0 bg-gray-500 opacity-75",onClick:o})}),(0,e.jsx)("span",{className:"hidden sm:inline-block sm:align-middle sm:h-screen","aria-hidden":"true",children:"â€‹"}),(0,e.jsx)("div",{className:"inline-block align-bottom bg-white rounded-lg text-left overflow-hidden shadow-xl transform transition-all sm:my-8 sm:align-middle sm:max-w-3xl sm:w-full",children:(0,e.jsxs)("div",{className:"bg-white px-4 pt-5 pb-4 sm:p-6 sm:pb-4",children:[(0,e.jsxs)("div",{className:"flex justify-between items-center mb-4",children:[(0,e.jsxs)("h3",{className:"text-lg leading-6 font-medium text-gray-900",id:"modal-title",children:[i.name,"'s Report"]}),(0,e.jsx)("button",{type:"button",className:"text-gray-400 hover:text-gray-500 focus:outline-none",onClick:o,children:(0,e.jsx)("svg",{className:"h-6 w-6",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,e.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M6 18L18 6M6 6l12 12"})})})]}),(0,e.jsxs)("div",{className:"grid grid-cols-2 gap-4 mb-6",children:[(0,e.jsxs)("div",{className:"bg-gray-50 p-4 rounded-lg",children:[(0,e.jsx)("p",{className:"text-sm text-gray-500",children:"Email"}),(0,e.jsx)("p",{className:"text-base font-medium",children:i.email||"N/A"})]}),(0,e.jsxs)("div",{className:"bg-gray-50 p-4 rounded-lg",children:[(0,e.jsx)("p",{className:"text-sm text-gray-500",children:"Phone"}),(0,e.jsx)("p",{className:"text-base font-medium",children:i.phone||"N/A"})]})]}),(0,e.jsxs)("div",{className:"mb-6",children:[(0,e.jsx)("h4",{className:"text-md font-medium text-gray-900 mb-3",children:"Deposits"}),h.length===0?(0,e.jsx)("p",{className:"text-gray-500",children:"No deposits found"}):(0,e.jsx)(tt,{data:h,columns:m,itemsPerPage:5})]}),(0,e.jsxs)("div",{children:[(0,e.jsx)("h4",{className:"text-md font-medium text-gray-900 mb-3",children:"Loans"}),y.length===0?(0,e.jsx)("p",{className:"text-gray-500",children:"No loans found"}):(0,e.jsx)(tt,{data:y,columns:w,itemsPerPage:5})]})]})})]})})},Ks=(a,o)=>{const[i,h]=(0,s.useState)(a);return(0,s.useEffect)(()=>{const y=setTimeout(()=>{h(a)},o);return()=>{clearTimeout(y)}},[a,o]),i},Gs=()=>{const a=new Date().getFullYear(),[o,i]=(0,s.useState)(a),[h,y]=(0,s.useState)("all"),[m,w]=(0,s.useState)(""),[p,j]=(0,s.useState)(!1),[x,g]=(0,s.useState)([]),[A,C]=(0,s.useState)({}),[N,U]=(0,s.useState)(null),[I,v]=(0,s.useState)(!1),[u,k]=(0,s.useState)(null),[S,R]=(0,s.useState)(null),[Y,P]=(0,s.useState)(!0),[_,q]=(0,s.useState)(null),[X,f]=(0,s.useState)({deposits:null,loans:null}),[D,E]=(0,s.useState)(1),n=20,r=Ks(m,300),c=(0,s.useMemo)(()=>{if(Object.keys(A).length===0)return[];let b=Object.values(A);return r&&(b=Bs(b,r)),p&&(b=b.filter(H=>H.unpaidLoansCount>0)),b},[A,r,p]),d=Math.ceil(c.length/n),F=(D-1)*n,$=F+n,B=c.slice(F,$);(0,s.useEffect)(()=>{E(1)},[c.length]);const W=(0,s.useMemo)(()=>u?{labels:u.labels,datasets:u.datasets}:null,[u]),l=(0,s.useMemo)(()=>S?{currentYear:{totalDeposits:S.currentYear.totalDeposits,totalLoans:S.currentYear.totalLoans,monthlyData:S.currentYear.monthlyData},previousYear:{totalDeposits:S.previousYear.totalDeposits,totalLoans:S.previousYear.totalLoans,monthlyData:S.previousYear.monthlyData}}:null,[S]),z=async()=>{try{const b=ae(J(T,"users")),H=await fe(b),oe=[];return H.forEach(G=>{oe.push({id:G.id,...G.data()})}),g(oe),oe}catch(b){return console.error("Error fetching users:",b),q("Failed to fetch users data"),[]}},M=async(b,H,oe)=>{try{try{const G=ae(J(T,"deposits"),ge("userId","in",b),ge("timestamp",">=",H),ge("timestamp","<=",oe),xe("timestamp","desc")),me=await fe(G),se={};return me.forEach(Z=>{const O={id:Z.id,...Z.data()};se[O.userId]||(se[O.userId]=[]),se[O.userId].push(O)}),se}catch(G){if(G.message.includes("requires an index")){console.warn("Index not found for deposits query, using fallback"),f(O=>({...O,deposits:G.message}));const me=ae(J(T,"deposits"),ge("userId","in",b)),se=await fe(me),Z={};return se.forEach(O=>{const V={id:O.id,...O.data()},ne=V.timestamp.toDate?V.timestamp.toDate():new Date(V.timestamp);ne>=H&&ne<=oe&&(Z[V.userId]||(Z[V.userId]=[]),Z[V.userId].push(V))}),Object.keys(Z).forEach(O=>{Z[O].sort((V,ne)=>{const ye=V.timestamp.toDate?V.timestamp.toDate():new Date(V.timestamp);return(ne.timestamp.toDate?ne.timestamp.toDate():new Date(ne.timestamp))-ye})}),Z}else throw G}}catch(G){return console.error("Error fetching deposits:",G),{}}},ee=async(b,H,oe)=>{try{try{const G=ae(J(T,"loans"),ge("userId","in",b),ge("timestamp",">=",H),ge("timestamp","<=",oe),xe("timestamp","desc")),me=await fe(G),se={};return me.forEach(Z=>{const O={id:Z.id,...Z.data()};se[O.userId]||(se[O.userId]=[]),se[O.userId].push(O)}),se}catch(G){if(G.message.includes("requires an index")){console.warn("Index not found for loans query, using fallback"),f(O=>({...O,loans:G.message}));const me=ae(J(T,"loans"),ge("userId","in",b)),se=await fe(me),Z={};return se.forEach(O=>{const V={id:O.id,...O.data()},ne=V.timestamp.toDate?V.timestamp.toDate():new Date(V.timestamp);ne>=H&&ne<=oe&&(Z[V.userId]||(Z[V.userId]=[]),Z[V.userId].push(V))}),Object.keys(Z).forEach(O=>{Z[O].sort((V,ne)=>{const ye=V.timestamp.toDate?V.timestamp.toDate():new Date(V.timestamp);return(ne.timestamp.toDate?ne.timestamp.toDate():new Date(ne.timestamp))-ye})}),Z}else throw G}}catch(G){return console.error("Error fetching loans:",G),{}}},K=(0,s.useCallback)(async()=>{P(!0),q(null);try{const b=await z(),H={};let oe=[],G=[],me,se;h==="all"?(me=Qe(o),se=Je(o)):(me=ut(o,parseInt(h)),se=ht(o,parseInt(h)));const Z=b.map(L=>L.id),O=[];for(let L=0;L<Z.length;L+=10)O.push(Z.slice(L,L+10));const V=O.map(L=>M(L,me,se)),ne=O.map(L=>ee(L,me,se)),ye=await Promise.all(V),yt=await Promise.all(ne),Ye={},_e={};ye.forEach(L=>{Object.keys(L).forEach(Q=>{Ye[Q]=L[Q],oe=[...oe,...L[Q]]})}),yt.forEach(L=>{Object.keys(L).forEach(Q=>{_e[Q]=L[Q],G=[...G,...L[Q]]})}),b.forEach(L=>{const Q=Ye[L.id]||[],qe=_e[L.id]||[],St=_s(Q,qe);H[L.id]={user:L,deposits:Q,loans:qe,...St}});const we=et(oe,G,o);k({labels:we.map(L=>L.month),datasets:[{label:"Deposits",data:we.map(L=>L.deposits),borderColor:"rgb(75, 192, 192)",backgroundColor:"rgba(75, 192, 192, 0.5)"},{label:"Loans",data:we.map(L=>L.loans),borderColor:"rgb(255, 99, 132)",backgroundColor:"rgba(255, 99, 132, 0.5)"}]});const Be=Qe(o-1),We=Je(o-1),jt=O.map(L=>M(L,Be,We)),bt=O.map(L=>ee(L,Be,We)),Nt=await Promise.all(jt),wt=await Promise.all(bt);let ve=[],Se=[];Nt.forEach(L=>{Object.keys(L).forEach(Q=>{ve=[...ve,...L[Q]]})}),wt.forEach(L=>{Object.keys(L).forEach(Q=>{Se=[...Se,...L[Q]]})});const vt=et(ve,Se,o-1);R({currentYear:{totalDeposits:oe.reduce((L,Q)=>L+Q.amount,0),totalLoans:G.reduce((L,Q)=>L+Q.amount,0),monthlyData:we},previousYear:{totalDeposits:ve.reduce((L,Q)=>L+Q.amount,0),totalLoans:Se.reduce((L,Q)=>L+Q.amount,0),monthlyData:vt}}),C(H),P(!1)}catch(b){console.error("Error fetching user reports:",b),q("Failed to fetch reports data"),P(!1)}},[o,h]),re=(0,s.useCallback)(b=>{U(b),v(!0)},[]),de=(0,s.useCallback)(()=>{v(!1),U(null)},[]),gt=(0,s.useCallback)(()=>{const b=Object.values(A);Ws(b,`annual-reports-${o}.csv`)},[A,o]),pt=(0,s.useCallback)(()=>{const b=Object.values(A),H=Ys(b,o);H.success?console.log(`PDF "${H.filename}" generated successfully!`):console.error("Failed to generate PDF:",H.error)},[A,o]);(0,s.useEffect)(()=>{K()},[K]);const ft=()=>{const b=[];for(let H=a;H>=2022;H--)b.push(H);return b};return(0,e.jsxs)("div",{className:"container mx-auto px-4 py-8",children:[(0,e.jsx)("h1",{className:"text-2xl font-bold text-gray-800 mb-6",children:"Annual Reports"}),(X.deposits||X.loans)&&(0,e.jsx)("div",{className:"bg-yellow-50 border-l-4 border-yellow-400 p-4 mb-6",children:(0,e.jsxs)("div",{className:"flex",children:[(0,e.jsx)("div",{className:"flex-shrink-0",children:(0,e.jsx)("svg",{className:"h-5 w-5 text-yellow-400",viewBox:"0 0 20 20",fill:"currentColor",children:(0,e.jsx)("path",{fillRule:"evenodd",d:"M8.257 3.099c.765-1.36 2.722-1.36 3.486 0l5.58 9.92c.75 1.334-.213 2.98-1.742 2.98H4.42c-1.53 0-2.493-1.646-1.743-2.98l5.58-9.92zM11 13a1 1 0 11-2 0 1 1 0 012 0zm-1-8a1 1 0 00-1 1v3a1 1 0 002 0V6a1 1 0 00-1-1z",clipRule:"evenodd"})})}),(0,e.jsxs)("div",{className:"ml-3",children:[(0,e.jsx)("p",{className:"text-sm text-yellow-700",children:"Some queries require Firestore indexes for optimal performance. We're using fallback queries, but you can create the indexes for better performance:"}),(0,e.jsxs)("div",{className:"mt-2",children:[X.deposits&&(0,e.jsx)("a",{href:"https://console.firebase.google.com/v1/r/project/ecommerce-74229/firestore/indexes?create_composite=ClBwcm9qZWN0cy9lY29tbWVyY2UtNzQyMjkvZGF0YWJhc2VzLyhkZWZhdWx0KS9jb2xsZWN0aW9uR3JvdXBzL2RlcG9zaXRzL2luZGV4ZXMvXxABGgoKBnVzZXJJZBABGg0KCXRpbWVzdGFtcBACGgwKCF9fbmFtZV9fEAI",target:"_blank",rel:"noopener noreferrer",className:"text-blue-600 underline hover:text-blue-800 mr-4",children:"Create Deposits Index"}),X.loans&&(0,e.jsx)("a",{href:"https://console.firebase.google.com/v1/r/project/ecommerce-74229/firestore/indexes?create_composite=Ck1wcm9qZWN0cy9lY29tbWVyY2UtNzQyMjkvZGF0YWJhc2VzLyhkZWZhdWx0KS9jb2xsZWN0aW9uR3JvdXBzL2xvYW5zL2luZGV4ZXMvXxABGgoKBnVzZXJJZBABGg0KCXRpbWVzdGFtcBACGgwKCF9fbmFtZV9fEAI",target:"_blank",rel:"noopener noreferrer",className:"text-blue-600 underline hover:text-blue-800",children:"Create Loans Index"})]})]})]})}),(0,e.jsxs)("div",{className:"bg-white shadow rounded-lg p-6 mb-6",children:[(0,e.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4 mb-4",children:[(0,e.jsxs)("div",{children:[(0,e.jsx)("label",{htmlFor:"year",className:"block text-sm font-medium text-gray-700 mb-1",children:"Year"}),(0,e.jsx)("select",{id:"year",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-blue-500 focus:border-blue-500",value:o,onChange:b=>i(parseInt(b.target.value)),children:ft().map(b=>(0,e.jsx)("option",{value:b,children:b},b))})]}),(0,e.jsxs)("div",{children:[(0,e.jsx)("label",{htmlFor:"month",className:"block text-sm font-medium text-gray-700 mb-1",children:"Month (Optional)"}),(0,e.jsxs)("select",{id:"month",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-blue-500 focus:border-blue-500",value:h,onChange:b=>y(b.target.value),children:[(0,e.jsx)("option",{value:"all",children:"All Months"}),(0,e.jsx)("option",{value:"1",children:"January"}),(0,e.jsx)("option",{value:"2",children:"February"}),(0,e.jsx)("option",{value:"3",children:"March"}),(0,e.jsx)("option",{value:"4",children:"April"}),(0,e.jsx)("option",{value:"5",children:"May"}),(0,e.jsx)("option",{value:"6",children:"June"}),(0,e.jsx)("option",{value:"7",children:"July"}),(0,e.jsx)("option",{value:"8",children:"August"}),(0,e.jsx)("option",{value:"9",children:"September"}),(0,e.jsx)("option",{value:"10",children:"October"}),(0,e.jsx)("option",{value:"11",children:"November"}),(0,e.jsx)("option",{value:"12",children:"December"})]})]}),(0,e.jsxs)("div",{children:[(0,e.jsx)("label",{htmlFor:"search",className:"block text-sm font-medium text-gray-700 mb-1",children:"Search User"}),(0,e.jsx)("input",{type:"text",id:"search",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-blue-500 focus:border-blue-500",placeholder:"Name, email, or phone",value:m,onChange:b=>w(b.target.value)})]}),(0,e.jsx)("div",{className:"flex items-end",children:(0,e.jsx)("button",{className:"w-full bg-blue-600 text-white px-4 py-2 rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2",onClick:K,children:"Apply Filters"})})]}),(0,e.jsxs)("div",{className:"flex flex-wrap gap-4 items-center",children:[(0,e.jsxs)("div",{className:"flex items-center",children:[(0,e.jsx)("input",{id:"showUnpaid",type:"checkbox",className:"h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded",checked:p,onChange:b=>j(b.target.checked)}),(0,e.jsx)("label",{htmlFor:"showUnpaid",className:"ml-2 block text-sm text-gray-700",children:"Show only users with unpaid loans"})]}),(0,e.jsx)("button",{className:"bg-green-600 text-white px-4 py-2 rounded-md hover:bg-green-700 focus:outline-none focus:ring-2 focus:ring-green-500 focus:ring-offset-2",onClick:gt,children:"Export CSV"}),(0,e.jsx)("button",{className:"bg-red-600 text-white px-4 py-2 rounded-md hover:bg-red-700 focus:outline-none focus:ring-2 focus:ring-red-500 focus:ring-offset-2",onClick:pt,children:"Export PDF"})]})]}),l&&(0,e.jsxs)("div",{className:"bg-white shadow rounded-lg p-6 mb-6",children:[(0,e.jsx)("h2",{className:"text-lg font-medium text-gray-800 mb-4",children:"Year Comparison"}),(0,e.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,e.jsxs)("div",{children:[(0,e.jsx)("h3",{className:"text-md font-medium text-gray-700 mb-2",children:"Total Deposits"}),(0,e.jsxs)("div",{className:"flex items-center",children:[(0,e.jsxs)("div",{className:"text-2xl font-bold text-green-600",children:["$",l.currentYear.totalDeposits.toFixed(2)]}),(0,e.jsxs)("div",{className:"ml-4 text-sm text-gray-500",children:[l.currentYear.totalDeposits>l.previousYear.totalDeposits?(0,e.jsxs)("span",{className:"text-green-600",children:["â†‘ ",((l.currentYear.totalDeposits-l.previousYear.totalDeposits)/l.previousYear.totalDeposits*100).toFixed(1),"%"]}):(0,e.jsxs)("span",{className:"text-red-600",children:["â†“ ",((l.previousYear.totalDeposits-l.currentYear.totalDeposits)/l.previousYear.totalDeposits*100).toFixed(1),"%"]}),(0,e.jsxs)("span",{children:[" vs ",o-1]})]})]})]}),(0,e.jsxs)("div",{children:[(0,e.jsx)("h3",{className:"text-md font-medium text-gray-700 mb-2",children:"Total Loans"}),(0,e.jsxs)("div",{className:"flex items-center",children:[(0,e.jsxs)("div",{className:"text-2xl font-bold text-blue-600",children:["$",l.currentYear.totalLoans.toFixed(2)]}),(0,e.jsxs)("div",{className:"ml-4 text-sm text-gray-500",children:[l.currentYear.totalLoans>l.previousYear.totalLoans?(0,e.jsxs)("span",{className:"text-green-600",children:["â†‘ ",((l.currentYear.totalLoans-l.previousYear.totalLoans)/l.previousYear.totalLoans*100).toFixed(1),"%"]}):(0,e.jsxs)("span",{className:"text-red-600",children:["â†“ ",((l.previousYear.totalLoans-l.currentYear.totalLoans)/l.previousYear.totalLoans*100).toFixed(1),"%"]}),(0,e.jsxs)("span",{children:[" vs ",o-1]})]})]})]})]})]}),W&&(0,e.jsxs)("div",{className:"bg-white shadow rounded-lg p-6 mb-6",children:[(0,e.jsx)("h2",{className:"text-lg font-medium text-gray-800 mb-4",children:"Deposits vs Loans by Month"}),(0,e.jsx)("div",{className:"h-64",children:(0,e.jsx)(Gt,{data:W,options:{responsive:!0,maintainAspectRatio:!1,plugins:{legend:{position:"top"},title:{display:!1}}}})})]}),(0,e.jsxs)("div",{className:"bg-white shadow rounded-lg overflow-hidden",children:[(0,e.jsx)("div",{className:"px-6 py-4 border-b border-gray-200",children:(0,e.jsx)("h2",{className:"text-lg font-medium text-gray-800",children:"Users Summary"})}),Y?(0,e.jsx)("div",{className:"px-6 py-4 text-center",children:(0,e.jsx)("p",{className:"text-gray-500",children:"Loading reports..."})}):_?(0,e.jsx)("div",{className:"px-6 py-4 text-center",children:(0,e.jsx)("p",{className:"text-red-500",children:_})}):c.length===0?(0,e.jsx)("div",{className:"px-6 py-4 text-center",children:(0,e.jsx)("p",{className:"text-gray-500",children:"No users found"})}):(0,e.jsxs)("div",{children:[(0,e.jsx)("div",{className:"overflow-x-auto",children:(0,e.jsxs)("table",{className:"min-w-full divide-y divide-gray-200",children:[(0,e.jsx)("thead",{className:"bg-gray-50",children:(0,e.jsxs)("tr",{children:[(0,e.jsx)("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"User"}),(0,e.jsx)("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Total Deposits"}),(0,e.jsx)("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Total Loans"}),(0,e.jsx)("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Paid Loans"}),(0,e.jsx)("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Unpaid Loans"}),(0,e.jsx)("th",{scope:"col",className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Action"})]})}),(0,e.jsx)("tbody",{className:"bg-white divide-y divide-gray-200",children:B.map(b=>(0,e.jsxs)("tr",{className:b.unpaidLoansCount>0?"border-l-4 border-red-500":"",children:[(0,e.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,e.jsxs)("div",{className:"flex items-center",children:[(0,e.jsx)("div",{className:"flex-shrink-0 h-10 w-10",children:(0,e.jsx)("div",{className:"h-10 w-10 rounded-full bg-gray-300 flex items-center justify-center",children:(0,e.jsx)("span",{className:"text-gray-600 font-medium",children:b.user.name?b.user.name.charAt(0).toUpperCase():"U"})})}),(0,e.jsxs)("div",{className:"ml-4",children:[(0,e.jsx)("div",{className:"text-sm font-medium text-gray-900",children:b.user.name||"Unknown User"}),(0,e.jsx)("div",{className:"text-sm text-gray-500",children:b.user.email||"N/A"})]})]})}),(0,e.jsxs)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:["$",b.totalDeposits.toFixed(2)]}),(0,e.jsxs)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:["$",b.totalLoans.toFixed(2)]}),(0,e.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:b.paidLoansCount}),(0,e.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,e.jsx)("span",{className:`px-2 inline-flex text-xs leading-5 font-semibold rounded-full ${b.unpaidLoansCount>0?"bg-red-100 text-red-800":"bg-green-100 text-green-800"}`,children:b.unpaidLoansCount})}),(0,e.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-right text-sm font-medium",children:(0,e.jsx)("button",{onClick:()=>re(b.user.id),className:"text-blue-600 hover:text-blue-900",children:t("viewDetails")})})]},b.user.id))})]})}),d>1&&(0,e.jsxs)("div",{className:"px-6 py-3 flex items-center justify-between border-t border-gray-200",children:[(0,e.jsxs)("div",{className:"flex-1 flex justify-between sm:hidden",children:[(0,e.jsx)("button",{onClick:()=>E(b=>Math.max(b-1,1)),disabled:D===1,className:"relative inline-flex items-center px-4 py-2 border border-gray-300 text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50",children:"Previous"}),(0,e.jsx)("button",{onClick:()=>E(b=>Math.min(b+1,d)),disabled:D===d,className:"ml-3 relative inline-flex items-center px-4 py-2 border border-gray-300 text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50",children:"Next"})]}),(0,e.jsxs)("div",{className:"hidden sm:flex-1 sm:flex sm:items-center sm:justify-between",children:[(0,e.jsx)("div",{children:(0,e.jsxs)("p",{className:"text-sm text-gray-700",children:["Showing ",(0,e.jsx)("span",{className:"font-medium",children:F+1})," to"," ",(0,e.jsx)("span",{className:"font-medium",children:Math.min($,c.length)})," of"," ",(0,e.jsx)("span",{className:"font-medium",children:c.length})," results"]})}),(0,e.jsx)("div",{children:(0,e.jsxs)("nav",{className:"relative z-0 inline-flex rounded-md shadow-sm -space-x-px","aria-label":"Pagination",children:[(0,e.jsx)("button",{onClick:()=>E(b=>Math.max(b-1,1)),disabled:D===1,className:"relative inline-flex items-center px-2 py-2 rounded-l-md border border-gray-300 bg-white text-sm font-medium text-gray-500 hover:bg-gray-50",children:"Previous"}),Array.from({length:d},(b,H)=>H+1).map(b=>(0,e.jsx)("button",{onClick:()=>E(b),className:`relative inline-flex items-center px-4 py-2 border text-sm font-medium ${D===b?"z-10 bg-blue-50 border-blue-500 text-blue-600":"bg-white border-gray-300 text-gray-500 hover:bg-gray-50"}`,children:b},b)),(0,e.jsx)("button",{onClick:()=>E(b=>Math.min(b+1,d)),disabled:D===d,className:"relative inline-flex items-center px-2 py-2 rounded-r-md border border-gray-300 bg-white text-sm font-medium text-gray-500 hover:bg-gray-50",children:"Next"})]})})]})]})]})]}),N&&(0,e.jsx)(Vs,{isOpen:I,onClose:de,user:A[N].user,deposits:A[N].deposits,loans:A[N].loans})]})},Hs=Gs,Zs=({onAccessGranted:a})=>{const[o,i]=(0,s.useState)(""),[h,y]=(0,s.useState)(!1),[m,w]=(0,s.useState)(""),[p,j]=(0,s.useState)(""),[x,g]=(0,s.useState)(!1),[A,C]=(0,s.useState)(""),[N,U]=(0,s.useState)(""),[I,v]=(0,s.useState)(""),[u,k]=(0,s.useState)(!1),[S,R]=(0,s.useState)(!1),[Y,P]=(0,s.useState)(!1),_="Communitysavings4@gmail.com";(0,s.useEffect)(()=>{if(N){R(!0);const n=setTimeout(()=>{R(!1),setTimeout(()=>U(""),500)},3e3);return()=>clearTimeout(n)}},[N]),(0,s.useEffect)(()=>{if(I){P(!0);const n=setTimeout(()=>{P(!1),setTimeout(()=>{v(""),x&&g(!1)},500)},3e3);return()=>clearTimeout(n)}},[I,x]);const q=async n=>{n.preventDefault(),k(!0);try{const r=te(T,"adminSettings","security"),c=await De(r);if(c.exists()){const{password:d}=c.data();o===d?a():U("Incorrect password. Please try again.")}else U("Admin settings not found. Please contact support.")}catch(r){console.error("Error fetching admin password:",r),U("Failed to verify password. Please try again.")}finally{k(!1)}},X=async n=>{n.preventDefault(),k(!0);try{const r=ms(),c=new Date;c.setMinutes(c.getMinutes()+15),await nt(te(T,"passwordResets",r),{token:r,expiresAt:c,used:!1});const d=`${window.location.origin}/admin-login?reset=true&token=${r}`;await us.send("service_rbtk5y8","template_i85brpa",{to_email:_,reset_link:d},"zcAI9wNXtOd3ooJ67"),v("Password reset email sent! Check your inbox."),setTimeout(()=>{y(!1)},3e3)}catch(r){console.error("Error sending password reset email:",r),U("Failed to send reset email. Please try again.")}finally{k(!1)}},f=async n=>{if(n.preventDefault(),m!==p){U("Passwords do not match.");return}if(m.length<6){U("Password must be at least 6 characters long.");return}k(!0);try{const r=te(T,"adminSettings","security");await ce(r,{password:m});const c=te(T,"passwordResets",A);await ce(c,{used:!0}),v("Password updated successfully!"),w(""),j(""),setTimeout(()=>{window.location.href="/admin-login"},3e3)}catch(r){console.error("Error updating password:",r),U("Failed to update password. Please try again.")}finally{k(!1)}};return(0,s.useEffect)(()=>{const n=new URLSearchParams(window.location.search),r=n.get("reset"),c=n.get("token");r==="true"&&c&&(async()=>{try{const F=te(T,"passwordResets",c),$=await De(F);if(!$.exists()){U("Invalid or expired reset link.");return}const B=$.data();if(B.used||new Date>B.expiresAt.toDate()){U("This reset link has expired.");return}g(!0),C(c)}catch(F){console.error("Error verifying reset token:",F),U("Failed to verify reset link.")}})()},[]),x?(0,e.jsx)("div",{className:"min-h-screen bg-gray-100 flex items-center justify-center",children:(0,e.jsxs)("div",{className:"bg-white shadow-lg rounded-2xl p-8 w-96 max-w-md",children:[(0,e.jsx)("h2",{className:"text-2xl font-bold text-center mb-6 text-gray-800",children:"Reset Admin Password"}),(0,e.jsxs)("form",{onSubmit:f,children:[(0,e.jsxs)("div",{className:"mb-4",children:[(0,e.jsx)("label",{htmlFor:"newPassword",className:"block text-sm font-medium text-gray-700 mb-1",children:"New Password"}),(0,e.jsx)("input",{type:"password",id:"newPassword",value:m,onChange:n=>w(n.target.value),className:"border border-gray-300 rounded-md p-3 focus:ring-2 focus:ring-blue-500 focus:border-blue-500 w-full transition-colors",required:!0})]}),(0,e.jsxs)("div",{className:"mb-6",children:[(0,e.jsx)("label",{htmlFor:"confirmPassword",className:"block text-sm font-medium text-gray-700 mb-1",children:"Confirm New Password"}),(0,e.jsx)("input",{type:"password",id:"confirmPassword",value:p,onChange:n=>j(n.target.value),className:"border border-gray-300 rounded-md p-3 focus:ring-2 focus:ring-blue-500 focus:border-blue-500 w-full transition-colors",required:!0})]}),(0,e.jsx)("button",{type:"submit",disabled:u,className:"bg-blue-600 hover:bg-blue-700 text-white font-semibold py-2 px-4 rounded-md w-full transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:u?"Updating...":"Reset Password"})]}),(0,e.jsx)("div",{className:"mt-4 text-center",children:(0,e.jsx)("button",{onClick:()=>g(!1),className:"text-blue-600 text-sm hover:underline",children:"Back to login"})}),N&&(0,e.jsx)("div",{className:`text-red-500 mt-4 transition-opacity duration-500 ${S?"opacity-100":"opacity-0"}`,children:N}),I&&(0,e.jsx)("div",{className:`text-green-500 mt-4 transition-opacity duration-500 ${Y?"opacity-100":"opacity-0"}`,children:I})]})}):(0,e.jsxs)("div",{className:"min-h-screen bg-gray-100 flex items-center justify-center",children:[(0,e.jsxs)("div",{className:"bg-white shadow-lg rounded-2xl p-8 w-96 max-w-md",children:[(0,e.jsx)("h2",{className:"text-2xl font-bold text-center mb-6 text-gray-800",children:"Admin Access"}),(0,e.jsxs)("form",{onSubmit:q,children:[(0,e.jsxs)("div",{className:"mb-4",children:[(0,e.jsx)("label",{htmlFor:"password",className:"block text-sm font-medium text-gray-700 mb-1",children:"Password"}),(0,e.jsx)("input",{type:"password",id:"password",value:o,onChange:n=>i(n.target.value),className:"border border-gray-300 rounded-md p-3 focus:ring-2 focus:ring-blue-500 focus:border-blue-500 w-full transition-colors",required:!0})]}),(0,e.jsx)("button",{type:"submit",disabled:u,className:"bg-blue-600 hover:bg-blue-700 text-white font-semibold py-2 px-4 rounded-md w-full mt-4 transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:u?"Verifying...":"Access Admin Dashboard"})]}),N&&(0,e.jsx)("div",{className:`text-red-500 mt-2 transition-opacity duration-500 ${S?"opacity-100":"opacity-0"}`,children:N}),I&&(0,e.jsx)("div",{className:`text-green-500 mt-2 transition-opacity duration-500 ${Y?"opacity-100":"opacity-0"}`,children:I}),(0,e.jsx)("div",{className:"text-blue-600 text-sm mt-3 hover:underline cursor-pointer text-center",onClick:()=>y(!0),children:"Forgot password?"})]}),h&&(0,e.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-40 flex items-center justify-center z-50",children:(0,e.jsxs)("div",{className:"bg-white shadow-lg rounded-2xl p-8 w-96 max-w-md",children:[(0,e.jsx)("h2",{className:"text-xl font-bold text-center mb-4 text-gray-800",children:"Reset Password"}),(0,e.jsx)("p",{className:"text-gray-600 text-sm mb-6",children:"A reset link will be sent to the admin email."}),(0,e.jsx)("div",{className:"mb-6 p-3 bg-gray-100 rounded-md",children:(0,e.jsxs)("p",{className:"text-sm text-gray-700",children:[(0,e.jsx)("span",{className:"font-medium",children:"Email:"})," ",_]})}),(0,e.jsx)("form",{onSubmit:X,children:(0,e.jsxs)("div",{className:"flex space-x-3",children:[(0,e.jsx)("button",{type:"button",onClick:()=>y(!1),className:"bg-gray-300 hover:bg-gray-400 text-gray-800 font-semibold py-2 px-4 rounded-md w-1/2 transition-colors",children:"Cancel"}),(0,e.jsx)("button",{type:"submit",disabled:u,className:"bg-blue-600 hover:bg-blue-700 text-white font-semibold py-2 px-4 rounded-md w-1/2 transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:u?"Sending...":"Send Reset Link"})]})}),N&&(0,e.jsx)("div",{className:`text-red-500 mt-4 transition-opacity duration-500 ${S?"opacity-100":"opacity-0"}`,children:N}),I&&(0,e.jsx)("div",{className:`text-green-500 mt-4 transition-opacity duration-500 ${Y?"opacity-100":"opacity-0"}`,children:I})]})})]})},Qs=Zs,Js=()=>{const a=Ne(),o=()=>{a("/")};return(0,e.jsx)("div",{className:"min-h-screen flex items-center justify-center bg-gray-50 p-4",children:(0,e.jsxs)("div",{className:"bg-white rounded-xl shadow-lg p-8 max-w-md w-full text-center",children:[(0,e.jsx)("div",{className:"mx-auto flex items-center justify-center h-16 w-16 rounded-full bg-red-100",children:(0,e.jsx)(ts,{className:"h-10 w-10 text-red-600"})}),(0,e.jsx)("h2",{className:"mt-4 text-2xl font-bold text-gray-900",children:"Account Blocked"}),(0,e.jsx)("p",{className:"mt-2 text-gray-600",children:"Your account has been blocked. Contact support if this is a mistake."}),(0,e.jsx)("button",{onClick:o,className:"mt-6 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors duration-200",children:"Back to Home"})]})})},Xs=Js,ea=()=>{const[a,o]=(0,s.useState)([]),[i,h]=(0,s.useState)(!0),[y,m]=(0,s.useState)(null);(0,s.useEffect)(()=>{const j=ae(J(T,"users")),x=le(j,g=>{try{const A=g.docs.map(C=>({id:C.id,...C.data()})).sort((C,N)=>C.createdAt&&N.createdAt?N.createdAt.toMillis()-C.createdAt.toMillis():C.createdAt?-1:N.createdAt?1:0);o(A),h(!1)}catch(A){console.error("Error processing users snapshot:",A),m("Failed to process users data"),h(!1)}},g=>{console.error("Error fetching users:",g),m("Failed to fetch users"),h(!1)});return()=>x()},[]);const w=async(j,x)=>{try{const g=te(T,"users",j);await ce(g,{isBlocked:!x})}catch(g){console.error("Error updating user block status:",g),m("Failed to update user status")}},p=j=>{if(!j)return"N/A";try{return j.toDate().toLocaleDateString()}catch{return"Invalid Date"}};return i?(0,e.jsx)("div",{className:"min-h-screen flex items-center justify-center bg-gray-50",children:(0,e.jsxs)("div",{className:"text-center",children:[(0,e.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-indigo-600 mx-auto"}),(0,e.jsx)("p",{className:"mt-4 text-gray-600",children:"Loading users..."})]})}):y?(0,e.jsx)("div",{className:"min-h-screen flex items-center justify-center bg-gray-50",children:(0,e.jsxs)("div",{className:"bg-white rounded-xl shadow-lg p-6 max-w-md w-full text-center",children:[(0,e.jsx)("div",{className:"mx-auto flex items-center justify-center h-16 w-16 rounded-full bg-red-100",children:(0,e.jsx)(Ge,{className:"h-10 w-10 text-red-600"})}),(0,e.jsx)("h3",{className:"mt-4 text-lg font-medium text-gray-900",children:"Error Loading Users"}),(0,e.jsx)("p",{className:"mt-2 text-gray-600",children:y})]})}):(0,e.jsxs)("div",{className:"p-4 md:p-6",children:[(0,e.jsxs)("div",{className:"mb-6",children:[(0,e.jsx)("h1",{className:"text-2xl font-bold text-gray-900",children:"User Management"}),(0,e.jsx)("p",{className:"mt-1 text-gray-600",children:"Manage user accounts and block/unblock users"})]}),(0,e.jsx)("div",{className:"bg-white rounded-xl shadow-md overflow-hidden",children:(0,e.jsxs)("div",{className:"overflow-x-auto",children:[(0,e.jsxs)("table",{className:"min-w-full divide-y divide-gray-200",children:[(0,e.jsx)("thead",{className:"bg-gray-50",children:(0,e.jsxs)("tr",{children:[(0,e.jsx)("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"User"}),(0,e.jsx)("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Email"}),(0,e.jsx)("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Join Date"}),(0,e.jsx)("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Status"}),(0,e.jsx)("th",{scope:"col",className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Actions"})]})}),(0,e.jsx)("tbody",{className:"bg-white divide-y divide-gray-200",children:a.map(j=>(0,e.jsxs)("tr",{className:"hover:bg-gray-50 transition-colors duration-150",children:[(0,e.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,e.jsxs)("div",{className:"flex items-center",children:[(0,e.jsx)("div",{className:"flex-shrink-0 h-10 w-10 rounded-full bg-indigo-100 flex items-center justify-center",children:(0,e.jsx)("span",{className:"text-indigo-800 font-medium",children:j.name?.charAt(0)?.toUpperCase()||"U"})}),(0,e.jsx)("div",{className:"ml-4",children:(0,e.jsx)("div",{className:"text-sm font-medium text-gray-900",children:j.name||"N/A"})})]})}),(0,e.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,e.jsx)("div",{className:"text-sm text-gray-900",children:j.email||"N/A"})}),(0,e.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,e.jsxs)("div",{className:"flex items-center text-sm text-gray-500",children:[(0,e.jsx)(cs,{className:"flex-shrink-0 mr-1.5 h-4 w-4 text-gray-400"}),p(j.createdAt)]})}),(0,e.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,e.jsx)("span",{className:`px-2 inline-flex text-xs leading-5 font-semibold rounded-full ${j.isBlocked?"bg-red-100 text-red-700":"bg-green-100 text-green-700"}`,children:j.isBlocked?"Blocked":"Active"})}),(0,e.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-right text-sm font-medium",children:(0,e.jsx)("button",{onClick:()=>w(j.id,j.isBlocked),className:`px-3 py-1 rounded-lg text-sm font-medium transition-colors duration-200 ${j.isBlocked?"bg-green-600 hover:bg-green-700 text-white":"bg-red-600 hover:bg-red-700 text-white"}`,children:j.isBlocked?"Unblock":"Block"})})]},j.id))})]}),a.length===0&&(0,e.jsxs)("div",{className:"text-center py-12",children:[(0,e.jsx)(Ge,{className:"mx-auto h-12 w-12 text-gray-400"}),(0,e.jsx)("h3",{className:"mt-2 text-sm font-medium text-gray-900",children:"No users found"}),(0,e.jsx)("p",{className:"mt-1 text-sm text-gray-500",children:"There are no users in the system yet."})]})]})})]})},ta=ea;const sa=async()=>{try{const a=pe.currentUser;if(!a)return!1;const o=te(T,"users",a.uid),i=await De(o);return i.exists()?i.data().isBlocked===!0:!1}catch(a){return console.error("Error checking user block status:",a),!1}},aa=async a=>{try{await Me(pe),a&&a("/blocked")}catch(o){console.error("Error signing out blocked user:",o)}},ra=async a=>{const o=await sa();return o&&await aa(a),o};var na=({children:a})=>{const o=Ne(),{currentUser:i}=he();return(0,s.useEffect)(()=>{const h=async()=>{if(i)try{await ra(o)}catch(m){console.error("Error checking user block status:",m)}};h();const y=setInterval(h,6e4);return()=>clearInterval(y)},[i,o]),(0,e.jsx)(e.Fragment,{children:a})},ia=na;function la({children:a}){const{currentUser:o}=he();return o?a:(0,e.jsx)(rt,{to:"/login"})}function st({children:a}){const{currentUser:o}=he();return o?(0,e.jsx)(rt,{to:"/dashboard"}):a}function oa(){const[a,o]=(0,s.useState)(!1);return a?(0,e.jsxs)(Lt,{children:[(0,e.jsx)(ie,{path:"/login",element:(0,e.jsx)(st,{children:(0,e.jsx)(bs,{})})}),(0,e.jsx)(ie,{path:"/signup",element:(0,e.jsx)(st,{children:(0,e.jsx)(Ns,{})})}),(0,e.jsx)(ie,{path:"/blocked",element:(0,e.jsx)(Xs,{})}),(0,e.jsxs)(ie,{path:"/",element:(0,e.jsx)(la,{children:(0,e.jsx)(ia,{children:(0,e.jsx)(Fs,{})})}),children:[(0,e.jsx)(ie,{index:!0,element:(0,e.jsx)(Ze,{})}),(0,e.jsx)(ie,{path:"profile",element:(0,e.jsx)(vs,{})}),(0,e.jsx)(ie,{path:"dashboard",element:(0,e.jsx)(Ze,{})}),(0,e.jsx)(ie,{path:"deposits",element:(0,e.jsx)(As,{})}),(0,e.jsx)(ie,{path:"loans",element:(0,e.jsx)(Is,{})}),(0,e.jsx)(ie,{path:"payback",element:(0,e.jsx)(ks,{})}),(0,e.jsx)(ie,{path:"users",element:(0,e.jsx)(Ms,{})}),(0,e.jsx)(ie,{path:"admin-users",element:(0,e.jsx)(ta,{})}),(0,e.jsx)(ie,{path:"settings",element:(0,e.jsx)(zs,{})}),(0,e.jsx)(ie,{path:"chat",element:(0,e.jsx)(Us,{})}),(0,e.jsx)(ie,{path:"annual-reports",element:(0,e.jsx)(Hs,{})})]})]}):(0,e.jsx)(Qs,{onAccessGranted:()=>o(!0)})}var da=oa;(0,ys.createRoot)(document.getElementById("root")).render((0,e.jsx)(s.StrictMode,{children:(0,e.jsx)(js,{children:(0,e.jsx)(Ut,{children:(0,e.jsx)(da,{})})})}));
